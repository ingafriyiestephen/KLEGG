System.register(["./index-legacy-LZepmReL.js","./index-legacy-DduMCVS-.js"],function(e,a){"use strict";var t,o,d,n,l,i,r,s,c,u,y,m,p,b,g,v,f,h,_,x,w,T,k,D,K,S,z,C,j,E,N,P,A,I,$,F,M,O,B,L,R,q,J,W;return{setters:[e=>{t=e.d,o=e.ao,d=e.r,n=e.S,l=e.a,i=e.o,r=e.b,s=e.w,c=e.u,u=e.I,y=e.e,m=e.f,p=e.g,b=e.h,g=e.i,v=e.P,f=e.l,h=e.A,_=e.q,x=e.k,w=e.s,T=e.a9,k=e.a3,D=e.t,K=e.v,S=e.n,z=e.J,C=e.a2,j=e.m,E=e.T,N=e.U,P=e.M,A=e.N,I=e.x,$=e.X,F=e.y,M=e.z,O=e.ap,B=e.C,L=e.a7,R=e.G,q=e.K,J=e._},e=>{W=e.T}],execute:function(){var a=document.createElement("style");a.textContent=".header-section[data-v-bdd37cb7]{margin-bottom:24px;text-align:center}.title[data-v-bdd37cb7]{display:block;font-size:1.5rem;font-weight:600;color:var(--ion-color-primary);margin-bottom:4px}.subtitle[data-v-bdd37cb7]{font-size:.9rem;color:var(--ion-color-medium)}.loading-container[data-v-bdd37cb7]{display:flex;justify-content:center;align-items:center;height:200px}.empty-state[data-v-bdd37cb7],.error-state[data-v-bdd37cb7]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:60vh;padding:20px}.empty-state ion-icon[data-v-bdd37cb7]{color:var(--ion-color-medium);font-size:64px;margin-bottom:16px}.error-state ion-icon[data-v-bdd37cb7]{font-size:64px;margin-bottom:16px}.empty-state h3[data-v-bdd37cb7],.error-state h3[data-v-bdd37cb7]{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--ion-color-dark)}.empty-state p[data-v-bdd37cb7],.error-state p[data-v-bdd37cb7]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:16px}.timetable-container[data-v-bdd37cb7]{display:flex;flex-direction:column;gap:16px}.day-card[data-v-bdd37cb7]{border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08);transition:transform .2s ease,box-shadow .2s ease;border-left:4px solid var(--ion-color-primary)}.today-card[data-v-bdd37cb7]{border-left:4px solid var(--ion-color-success);background:rgba(var(--ion-color-success-rgb),.05)}.day-title[data-v-bdd37cb7]{display:flex;align-items:center;justify-content:space-between;font-size:1.1rem;font-weight:600}.time-content[data-v-bdd37cb7]{padding-top:0}.time-content ion-item[data-v-bdd37cb7]{--padding-start: 0;--inner-padding-end: 0}.time-content ion-icon[data-v-bdd37cb7]{margin-right:8px}.day-card[data-v-bdd37cb7]:active{transform:scale(.98)}@media (min-width: 768px){.timetable-container[data-v-bdd37cb7]{display:grid;grid-template-columns:repeat(2,1fr)}}\n",document.head.appendChild(a);const G={class:"header-section"},U={key:0,class:"loading-container"},V={key:1,class:"empty-state"},X={key:2,class:"error-state"},Y={key:3,class:"timetable-container"};e("default",J(t({__name:"TimetablePage",setup(e){const a=localStorage.getItem("parisklegg_token")||"",t=localStorage.getItem("parisklegg_user");t&&JSON.parse(t);const J=o(),H=m(),Q=Number(J.params.id),Z=d(""),ee=d(""),ae=d(!0),te=d(!1),oe=d(!1),de=d([]),ne=async()=>{try{ae.value=!0,te.value=!1;const e=await y.post("https://school.klgilc.com/api/timetable",{tutorship_id:Q},{headers:ie(),timeout:2e4});console.log("Timetable response:",e.data),le(e.data)}catch(e){re(e),te.value=!0}finally{ae.value=!1}},le=e=>{const a=[{name:"Monday",dayKey:"monday"},{name:"Tuesday",dayKey:"tuesday"},{name:"Wednesday",dayKey:"wednesday"},{name:"Thursday",dayKey:"thursday"},{name:"Friday",dayKey:"friday"},{name:"Saturday",dayKey:"saturday"},{name:"Sunday",dayKey:"sunday"}],t=(new Date).getDay(),o=a[0===t?6:t-1].dayKey;de.value=[],oe.value=!1,e.forEach(e=>{e.tutorship_id===Q&&(Z.value=e.tutorship_name||"My Timetable",a.forEach(a=>{const t=e[`${a.dayKey}_start`],d=e[`${a.dayKey}_end`];((e,a)=>!!e&&""!==e.trim()&&!!a&&""!==a.trim())(t,d)&&(oe.value=!0,de.value.push({name:a.name,dayKey:a.dayKey,startTime:t,endTime:d,isToday:a.dayKey===o}))}))})},ie=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${a}`}),re=e=>{if(console.error("Error fetching data:",e),y.isAxiosError(e)){var a;if(401===(null===(a=e.response)||void 0===a?void 0:a.status))return H.replace("/"),void W.show({text:"Session expired. Please login again",position:"top",duration:"long"});if("ECONNABORTED"===e.code)return void W.show({text:"Request timeout. Please try again",position:"top"})}W.show({text:"Failed to load data. Please try again later",position:"top"})};return n.setOverlaysWebView({overlay:!1}),n.setBackgroundColor({color:"#ffffff"}),n.setStyle({style:l.Light}),i(()=>{ee.value=(()=>{const e=new Date,a=e.getDay()||7,t=new Date(e);t.setDate(e.getDate()-a+1);const o=new Date(t);o.setDate(t.getDate()+6);const d={month:"short",day:"numeric"};return`${t.toLocaleDateString(void 0,d)} - ${o.toLocaleDateString(void 0,d)}`})(),ne(),console.log("Mounted: Fetching timetable for tutorship ID:",Q)}),(e,a)=>(A(),r(c(u),null,{default:s(()=>[p(c(_),null,{default:s(()=>[p(c(b),null,{default:s(()=>[p(c(g),{slot:"start"},{default:s(()=>[p(c(v),{"default-href":"/"})]),_:1}),p(c(f),null,{default:s(()=>a[0]||(a[0]=[h("Timetable",-1)])),_:1,__:[0]})]),_:1})]),_:1}),p(c(P),{class:"ion-padding",fullscreen:!0},{default:s(()=>[x("div",G,[Z.value?(A(),r(c(k),{key:0,class:"title"},{default:s(()=>[h(D(Z.value),1)]),_:1})):T("",!0),p(c(k),{class:"subtitle"},{default:s(()=>[h(D(ee.value),1)]),_:1})]),ae.value?(A(),w("div",U,[p(c(K),{name:"crescent",color:"primary"})])):oe.value?te.value?(A(),w("div",X,[p(c(S),{icon:c(C),color:"danger",size:"large"},null,8,["icon"]),p(c(k),null,{default:s(()=>a[2]||(a[2]=[x("h3",null,"Failed to load timetable",-1),x("p",null,"Please try again later",-1)])),_:1,__:[2]}),p(c(j),{onClick:ne,fill:"clear"},{default:s(()=>a[3]||(a[3]=[h("Retry",-1)])),_:1,__:[3]})])):(A(),w("div",Y,[(A(!0),w(E,null,N(de.value,(e,t)=>(A(),r(c(I),{key:t,class:$(["day-card",{"today-card":e.isToday}])},{default:s(()=>[p(c(F),null,{default:s(()=>[p(c(M),{class:"day-title"},{default:s(()=>[h(D(e.name)+" ",1),e.isToday?(A(),r(c(O),{key:0,color:"success"},{default:s(()=>a[4]||(a[4]=[h("Today",-1)])),_:1,__:[4]})):T("",!0)]),_:2},1024)]),_:2},1024),p(c(B),{class:"time-content"},{default:s(()=>[p(c(L),{lines:"none"},{default:s(()=>[p(c(S),{slot:"start",icon:c(R),color:"primary"},null,8,["icon"]),p(c(q),null,{default:s(()=>[h(D(e.startTime)+" - "+D(e.endTime),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"]))),128))])):(A(),w("div",V,[p(c(S),{icon:c(z),size:"large"},null,8,["icon"]),p(c(k),null,{default:s(()=>a[1]||(a[1]=[x("h3",null,"No Classes Scheduled",-1),x("p",null,"Your timetable will appear here when classes are scheduled",-1)])),_:1,__:[1]})]))]),_:1})]),_:1}))}}),[["__scopeId","data-v-bdd37cb7"]]))}}});
