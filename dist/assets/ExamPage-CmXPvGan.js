import{d as Y,ar as G,r as v,c as g,S as y,a as J,o as W,b as E,w as s,u as e,I as X,e as b,f as $,g as t,h as K,i as Q,P as U,l as Z,A as o,q as ee,s as c,x as w,y as S,z as B,n as x,aP as ae,C as N,k as u,a3 as r,t as i,X as P,v as te,az as se,a2 as le,m as oe,a9 as R,M as re,N as d,_ as ne}from"./index-CKBFjtUw.js";import{T as k}from"./index-C0PW9qWZ.js";const ue={class:"summary-item"},ie={class:"summary-item"},de={key:0,class:"loading-container"},ce={key:1,class:"empty-state"},me={key:2,class:"error-state"},fe={class:"detail-row"},_e={class:"detail-row"},pe={key:0,class:"detail-row"},ve={key:1,class:"feedback-section"},ge=Y({__name:"ExamPage",setup(ye){const T=localStorage.getItem("parisklegg_token")||"",I=localStorage.getItem("parisklegg_user"),_=I?JSON.parse(I):null,D=(_==null?void 0:_.user_id)||0,O=$(),z=G(),A=Number(z.params.id),p=v(!0),m=v(!1),n=v({student_id:0,tutorship_id:0,score_numerator:0,score_denominator:0}),V=g(()=>n.value!==null),F=g(()=>{var l;return((l=n.value)==null?void 0:l.tutorship_name)||"Exam"}),f=g(()=>n.value?H(n.value.score_numerator,n.value.score_denominator):0),H=(l,a)=>a===0?0:Math.round(l/a*100),h=l=>l>=85?"excellent":l>=70?"good":l>=50?"average":"poor",L=l=>{const a=new Date(l),q={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return a.toLocaleDateString(void 0,q)},C=async()=>{try{p.value=!0,m.value=!1,n.value={student_id:0,tutorship_id:0,score_numerator:0,score_denominator:0};const l=await b.post("https://klegg-app-whh7m.ondigitalocean.app/api/exams",{tutorship_id:A,student_id:D},{headers:M(),timeout:2e4});l.data.length>0&&(n.value=l.data[0])}catch(l){console.error("Error fetching exam results:",l),j(l),m.value=!0}finally{p.value=!1}},M=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(T)}),j=l=>{var a;if(console.error("Error fetching data:",l),b.isAxiosError(l)){if(((a=l.response)==null?void 0:a.status)===401){O.replace("/"),k.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(l.code==="ECONNABORTED"){k.show({text:"Request timeout. Please try again",position:"top"});return}}k.show({text:"Failed to load data. Please try again later",position:"top"})};return y.setOverlaysWebView({overlay:!1}),y.setBackgroundColor({color:"#ffffff"}),y.setStyle({style:J.Light}),W(()=>{C()}),(l,a)=>(d(),E(e(X),null,{default:s(()=>[t(e(ee),null,{default:s(()=>[t(e(K),null,{default:s(()=>[t(e(Q),{slot:"start"},{default:s(()=>[t(e(U),{"default-href":"/"})]),_:1}),t(e(Z),null,{default:s(()=>[...a[0]||(a[0]=[o("Exam Results",-1)])]),_:1})]),_:1})]),_:1}),t(e(re),{fullscreen:!0},{default:s(()=>[t(e(w),{class:"summary-card"},{default:s(()=>[t(e(S),null,{default:s(()=>[t(e(B),{class:"summary-title"},{default:s(()=>[t(e(x),{icon:e(ae),color:"primary"},null,8,["icon"]),a[1]||(a[1]=o(" Exam Overview ",-1))]),_:1})]),_:1}),t(e(N),{class:"summary-content"},{default:s(()=>[u("div",ue,[t(e(r),{class:"summary-label"},{default:s(()=>[...a[2]||(a[2]=[o("Exam",-1)])]),_:1}),t(e(r),{class:"summary-value"},{default:s(()=>[o(i(F.value),1)]),_:1})]),a[4]||(a[4]=u("div",{class:"divider"},null,-1)),u("div",ie,[t(e(r),{class:"summary-label"},{default:s(()=>[...a[3]||(a[3]=[o("Your Score",-1)])]),_:1}),t(e(r),{class:P(["summary-value",h(f.value)])},{default:s(()=>[o(i(f.value)+"% ",1)]),_:1},8,["class"])])]),_:1})]),_:1}),p.value?(d(),c("div",de,[t(e(te),{name:"crescent",color:"primary"})])):!V.value&&!m.value?(d(),c("div",ce,[t(e(x),{icon:e(se),size:"large",color:"medium"},null,8,["icon"]),t(e(r),null,{default:s(()=>[...a[5]||(a[5]=[u("h3",null,"No Exam Results",-1),u("p",null,"Your exam results will appear here once available",-1)])]),_:1})])):m.value?(d(),c("div",me,[t(e(x),{icon:e(le),size:"large",color:"danger"},null,8,["icon"]),t(e(r),null,{default:s(()=>[...a[6]||(a[6]=[u("h3",null,"Error Loading Results",-1),u("p",null,"Please try again later",-1)])]),_:1}),t(e(oe),{fill:"clear",onClick:C},{default:s(()=>[...a[7]||(a[7]=[o("Retry",-1)])]),_:1})])):(d(),E(e(w),{key:3,class:"details-card"},{default:s(()=>[t(e(S),null,{default:s(()=>[t(e(B),null,{default:s(()=>[...a[8]||(a[8]=[o("Detailed Results",-1)])]),_:1})]),_:1}),t(e(N),null,{default:s(()=>[u("div",fe,[t(e(r),{class:"detail-label"},{default:s(()=>[...a[9]||(a[9]=[o("Score",-1)])]),_:1}),t(e(r),{class:"detail-value"},{default:s(()=>[o(i(n.value.score_numerator)+"/"+i(n.value.score_denominator),1)]),_:1})]),u("div",_e,[t(e(r),{class:"detail-label"},{default:s(()=>[...a[10]||(a[10]=[o("Percentage",-1)])]),_:1}),t(e(r),{class:P(["detail-value",h(f.value)])},{default:s(()=>[o(i(f.value)+"% ",1)]),_:1},8,["class"])]),n.value.created_at?(d(),c("div",pe,[t(e(r),{class:"detail-label"},{default:s(()=>[...a[11]||(a[11]=[o("Date Taken",-1)])]),_:1}),t(e(r),{class:"detail-value"},{default:s(()=>[o(i(L(n.value.created_at)),1)]),_:1})])):R("",!0),n.value.comments?(d(),c("div",ve,[t(e(r),{class:"feedback-title"},{default:s(()=>[...a[12]||(a[12]=[o("Instructor Feedback",-1)])]),_:1}),t(e(r),{class:"feedback-content"},{default:s(()=>[o(i(n.value.comments),1)]),_:1})])):R("",!0)]),_:1})]),_:1}))]),_:1})]),_:1}))}}),Ie=ne(ge,[["__scopeId","data-v-90c9fc80"]]);export{Ie as default};
