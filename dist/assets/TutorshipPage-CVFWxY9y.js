import{d as L,r as y,S as C,a as H,O as J,o as Y,b as Q,w as i,u as o,I as U,e as E,f as X,g as n,h as Z,i as $,P as G,l as K,A as w,m as I,n as g,Q as tt,q as et,s as c,k as e,R as st,T as x,U as A,M as ot,N as r,t as u,V as N,W as nt,X as at,J as lt,Y as it,Z as rt,$ as P,a0 as ct,a1 as ut,_ as dt}from"./index-CKBFjtUw.js";import{T as B}from"./index-C0PW9qWZ.js";const pt={key:0,class:"loading-container"},_t={key:1,class:"creative-empty-state"},gt={key:2,class:"class-grid"},ht=["onClick"],ft={class:"card-content"},bt={class:"card-header"},vt={class:"subject-badge"},kt=["onClick"],mt={class:"subject-name"},yt={class:"ribbon-row top-row"},Ct=["onClick"],wt={class:"ribbon-row bottom-row"},xt=["onClick"],At=L({__name:"TutorshipPage",setup(Nt){const R=localStorage.getItem("parisklegg_token")||"",O=localStorage.getItem("parisklegg_user"),h=O?JSON.parse(O):null,f=(h==null?void 0:h.user_id)||0;console.log(f);const b=X(),v=y(null),d=y(!0),k=y([]),m=async()=>{try{d.value=!0;const s=await E.get("https://klegg-app-whh7m.ondigitalocean.app/api/tutorships",{headers:W(),timeout:2e4});if(isNaN(f))throw new Error("Invalid student ID");k.value=s.data.filter(t=>{var p;try{return(((p=t.students_list)==null?void 0:p.split(",").map(Number).filter(_=>!isNaN(_)))||[]).includes(f)}catch(l){return console.warn("Error parsing students_list",t),!1}}).map(t=>({...t,rating_score:t.average_rating!==void 0?parseFloat(t.average_rating.toFixed(1)):void 0}))}catch(s){z(s)}finally{d.value=!1}},S=()=>{d.value=!0,m()},F=s=>({default:"ðŸ“–"}).default,T=[{id:1,icon:lt,label:"Timetable",url:"timetable"},{id:2,icon:it,label:"Attendance",url:"attendance"},{id:3,icon:rt,label:"Assignment",url:"assignment"}],M=[{id:4,icon:ct,label:"Assessment",url:"assessment"},{id:5,icon:ut,label:"Exam",url:"exam"}],V=s=>{v.value=v.value===s?null:s},q=(s,t)=>{b.push("/rate/".concat(s))},j=(s,t)=>{b.push("/".concat(t,"/").concat(s,"/"))},W=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(R)}),z=s=>{var t;if(console.error("Error fetching data:",s),E.isAxiosError(s)){if(((t=s.response)==null?void 0:t.status)===401){b.replace("/"),B.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(s.code==="ECONNABORTED"){B.show({text:"Request timeout. Please try again",position:"top"});return}}B.show({text:"Failed to load data. Please try again later",position:"top"})};return C.setOverlaysWebView({overlay:!1}),C.setBackgroundColor({color:"#ffffff"}),C.setStyle({style:H.Light}),J(async()=>{await m()}),Y(m),(s,t)=>{const p=st("ion-spinner");return r(),Q(o(U),{class:"modern-school-theme"},{default:i(()=>[n(o(et),{class:"header-gradient"},{default:i(()=>[n(o(Z),null,{default:i(()=>[n(o($),{slot:"start"},{default:i(()=>[n(o(G),{"default-href":"/home",class:"back-button"})]),_:1}),n(o(K),{class:"page-title"},{default:i(()=>[...t[0]||(t[0]=[w("My Classes",-1)])]),_:1}),n(o($),{slot:"end"},{default:i(()=>[n(o(I),{onClick:S,fill:"clear",class:"refresh-btn"},{default:i(()=>[n(o(g),{icon:o(tt),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),n(o(ot),{fullscreen:!0,class:"content-bg"},{default:i(()=>[d.value?(r(),c("div",pt,[n(p,{name:"crescent",color:"primary"}),t[1]||(t[1]=e("p",null,"Loading your classes...",-1))])):k.value.length===0?(r(),c("div",_t,[t[3]||(t[3]=e("div",{class:"desk-illustration"},[e("div",{class:"desk"}),e("div",{class:"lamp"}),e("div",{class:"book-stack"},[e("div",{class:"book"}),e("div",{class:"book"}),e("div",{class:"book"})])],-1)),t[4]||(t[4]=e("h3",null,"No Classes Yet",-1)),t[5]||(t[5]=e("p",null,"When you enroll in a class, it'll appear here",-1)),n(o(I),{onClick:S,fill:"solid",class:"cta-button"},{default:i(()=>[...t[2]||(t[2]=[w(" Check Again ",-1)])]),_:1})])):(r(),c("div",gt,[(r(!0),c(x,null,A(k.value,l=>{var _;return r(),c("div",{key:l.tutorship_id,class:"class-card",onClick:a=>V(l.tutorship_id)},[e("div",ft,[e("div",bt,[e("div",vt,u(F(l.subject_name)),1),e("div",{class:"quick-action",onClick:N(a=>q(l.tutorship_id,"rate"),["stop"])},[n(o(g),{icon:o(nt)},null,8,["icon"]),w(" "+u(((_=l.average_rating)==null?void 0:_.toFixed(1))||"Rate"),1)],8,kt)]),e("h3",null,u(l.tutorship_name),1),e("p",mt,u(l.subject_name),1)]),e("div",{class:at(["action-ribbon two-row",{active:v.value===l.tutorship_id}])},[e("div",yt,[(r(),c(x,null,A(T,a=>e("button",{key:"first-"+a.id,onClick:N(D=>j(l.tutorship_id,a.label),["stop"]),class:"ribbon-button",style:P({"--delay":a.id})},[n(o(g),{icon:a.icon},null,8,["icon"]),e("span",null,u(a.label),1)],12,Ct)),64))]),e("div",wt,[(r(),c(x,null,A(M,a=>e("button",{key:"second-"+a.id,onClick:N(D=>j(l.tutorship_id,a.url),["stop"]),class:"ribbon-button",style:P({"--delay":a.id+T.length})},[n(o(g),{icon:a.icon},null,8,["icon"]),e("span",null,u(a.label),1)],12,xt)),64))])],2)],8,ht)}),128))]))]),_:1})]),_:1})}}}),St=dt(At,[["__scopeId","data-v-a8977815"]]);export{St as default};
