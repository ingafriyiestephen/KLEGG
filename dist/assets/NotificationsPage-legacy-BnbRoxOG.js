!function(){function t(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var o,n,r="function"==typeof Symbol?Symbol:{},e=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function c(t,r,e,i){var c=r&&r.prototype instanceof u?r:u,d=Object.create(c.prototype);return a(d,"_invoke",function(t,a,r){var e,i,c,u=0,d=r||[],s=!1,p={p:0,n:0,v:o,a:f,f:f.bind(o,4),d:function(t,a){return e=t,i=0,c=o,p.n=a,l}};function f(t,a){for(i=t,c=a,n=0;!s&&u&&!r&&n<d.length;n++){var r,e=d[n],f=p.p,v=e[2];t>3?(r=v===a)&&(c=e[(i=e[4])?5:(i=3,3)],e[4]=e[5]=o):e[0]<=f&&((r=t<2&&f<e[1])?(i=0,p.v=a,p.n=e[1]):f<v&&(r=t<3||e[0]>a||a>v)&&(e[4]=t,e[5]=a,p.n=v,i=0))}if(r||t>1)return l;throw s=!0,a}return function(r,d,v){if(u>1)throw TypeError("Generator is already running");for(s&&1===d&&f(d,v),i=d,c=v;(n=i<2?o:c)||!s;){e||(i?i<3?(i>1&&(p.n=-1),f(i,c)):p.n=c:p.v=c);try{if(u=2,e){if(i||(r="next"),n=e[r]){if(!(n=n.call(e,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=e.return)&&n.call(e),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);e=o}else if((n=(s=p.n<0)?c:t.call(a,p))!==l)break}catch(n){e=o,i=1,c=n}finally{u=1}}return{value:n,done:s}}}(t,e,i),!0),d}var l={};function u(){}function d(){}function s(){}n=Object.getPrototypeOf;var p=[][e]?n(n([][e]())):(a(n={},e,function(){return this}),n),f=s.prototype=u.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,a(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return d.prototype=s,a(f,"constructor",s),a(s,"constructor",d),d.displayName="GeneratorFunction",a(s,i,"GeneratorFunction"),a(f),a(f,i,"Generator"),a(f,e,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(t=function(){return{w:c,m:v}})()}function a(t,o,n,r){var e=Object.defineProperty;try{e({},"",{})}catch(t){e=0}a=function(t,o,n,r){function i(o,n){a(t,o,function(t){return this._invoke(o,n,t)})}o?e?e(t,o,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[o]=n:(i("next",0),i("throw",1),i("return",2))},a(t,o,n,r)}function o(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,a){if(t){if("string"==typeof t)return n(t,a);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?n(t,a):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,a){(null==a||a>t.length)&&(a=t.length);for(var o=0,n=Array(a);o<a;o++)n[o]=t[o];return n}function r(t,a,o,n,r,e,i){try{var c=t[e](i),l=c.value}catch(t){return void o(t)}c.done?a(l):Promise.resolve(l).then(n,r)}function e(t){return function(){var a=this,o=arguments;return new Promise(function(n,e){var i=t.apply(a,o);function c(t){r(i,n,e,c,l,"next",t)}function l(t){r(i,n,e,c,l,"throw",t)}c(void 0)})}}System.register(["./index-legacy-BDm5fI0y.js","./index-legacy-5QTRqfGm.js"],function(a,n){"use strict";var r,i,c,l,u,d,s,p,f,v,g,m,b,h,x,y,w,k,_,S,j,z,O,P,E,I,N,A,T,C,L,G,F,R,B,D,$,H,M,U,q,J,Y,K;return{setters:[function(t){r=t.d,i=t.r,c=t.P,l=t.o,u=t.a,d=t.w,s=t.u,p=t.I,f=t.b,v=t.e,g=t.f,m=t.g,b=t.h,h=t.m,x=t.B,y=t.s,w=t.v,k=t.l,_=t.x,S=t.p,j=t.a2,z=t.a3,O=t.n,P=t.F,E=t.a4,I=t.S,N=t.R,A=t.a5,T=t.a6,C=t.N,L=t.L,G=t.O,F=t.a7,R=t.k,B=t.a8,D=t.a9,$=t.aa,H=t.t,M=t.ab,U=t.ac,q=t.ad,J=t.ae,Y=t._},function(t){K=t.T}],execute:function(){var n=document.createElement("style");n.textContent=".loading-container[data-v-6b08a1a0]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:60vh;text-align:center;background:var(--ion-background-color)}.loading-container ion-spinner[data-v-6b08a1a0]{width:48px;height:48px;margin-bottom:16px;color:var(--ion-color-primary)}.loading-container p[data-v-6b08a1a0]{color:var(--ion-color-medium);margin-top:8px}.error-state[data-v-6b08a1a0],.empty-state[data-v-6b08a1a0]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:60vh;padding:20px;background:var(--ion-background-color)}.error-state ion-icon[data-v-6b08a1a0],.empty-state ion-icon[data-v-6b08a1a0]{margin-bottom:16px;font-size:64px;opacity:.8}.error-state ion-icon[data-v-6b08a1a0]{color:var(--ion-color-danger)}.empty-state ion-icon[data-v-6b08a1a0]{color:var(--ion-color-medium)}.error-state h3[data-v-6b08a1a0],.empty-state h3[data-v-6b08a1a0]{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--ion-text-color)}.error-state p[data-v-6b08a1a0],.empty-state p[data-v-6b08a1a0]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:16px;line-height:1.4}.notification-item[data-v-6b08a1a0]{--padding-start: 16px;--padding-end: 16px;--inner-padding-end: 16px;--border-color: var(--ion-border-color);--background: var(--ion-item-background);margin-bottom:1px}.notification-item.unread[data-v-6b08a1a0]{--background: rgba(var(--ion-color-primary-rgb), .08);border-left:3px solid var(--ion-color-primary)}.notification-item[data-v-6b08a1a0]:last-child{margin-bottom:0}.notification-avatar[data-v-6b08a1a0]{width:48px;height:48px;margin-right:16px;border:2px solid var(--ion-border-color);background:var(--ion-color-step-100)}.notification-content[data-v-6b08a1a0]{flex:1}.notification-item h2[data-v-6b08a1a0]{font-size:1rem;font-weight:600;margin-bottom:6px;color:var(--ion-text-color);line-height:1.3}.preview-text[data-v-6b08a1a0]{font-size:.9rem;color:var(--ion-text-color);margin-bottom:8px;line-height:1.4;opacity:.9}.notification-meta[data-v-6b08a1a0]{display:flex;align-items:center;gap:12px;font-size:.8rem;color:var(--ion-color-medium);margin-top:8px}.notification-meta ion-badge[data-v-6b08a1a0]{font-size:.7rem;font-weight:500;padding:4px 8px;--background: var(--ion-color-step-200);--color: var(--ion-text-color)}.notification-meta ion-badge.primary[data-v-6b08a1a0]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}.date[data-v-6b08a1a0]{flex:1;color:var(--ion-color-medium)}.reactions-row[data-v-6b08a1a0]{display:flex;gap:6px;margin:12px 0 8px;flex-wrap:wrap}.reactions-row ion-chip[data-v-6b08a1a0]{--background: var(--ion-color-step-100);--color: var(--ion-text-color);height:28px;margin:0;font-size:.8rem}.reactions-row ion-chip[data-v-6b08a1a0]:active{--background: var(--ion-color-step-200)}.reactions-row ion-icon[data-v-6b08a1a0]{margin-right:4px;font-size:14px;color:var(--ion-color-primary)}.reactions-row ion-label[data-v-6b08a1a0]{font-size:.75rem;font-weight:500}.comments-count[data-v-6b08a1a0]{display:flex;align-items:center;gap:4px;color:var(--ion-color-medium)}.comments-count ion-icon[data-v-6b08a1a0]{font-size:16px}.notification-actions[data-v-6b08a1a0]{display:flex;gap:8px;margin-top:12px;padding-top:12px;border-top:1px solid var(--ion-border-color)}.action-button[data-v-6b08a1a0]{--padding-start: 12px;--padding-end: 12px;--border-radius: 6px;font-size:.8rem;height:32px}.dark .notification-item.unread[data-v-6b08a1a0]{--background: rgba(var(--ion-color-primary-rgb), .12);border-left-color:var(--ion-color-primary)}.dark .reactions-row ion-chip[data-v-6b08a1a0]{--background: var(--ion-color-step-200)}.dark .notification-avatar[data-v-6b08a1a0]{background:var(--ion-color-step-200);border-color:var(--ion-color-step-300)}.notification-item[data-v-6b08a1a0]:focus-visible{outline:2px solid var(--ion-color-primary);outline-offset:-2px}.reactions-row ion-chip[data-v-6b08a1a0]:focus-visible{outline:2px solid var(--ion-color-primary);outline-offset:2px}@media (hover: hover){.notification-item[data-v-6b08a1a0]:hover{--background: var(--ion-color-step-50)}.reactions-row ion-chip[data-v-6b08a1a0]:hover{--background: var(--ion-color-step-150)}}@keyframes highlightPulse-6b08a1a0{0%{background-color:rgba(var(--ion-color-primary-rgb),.1)}50%{background-color:rgba(var(--ion-color-primary-rgb),.2)}to{background-color:rgba(var(--ion-color-primary-rgb),.1)}}.notification-item.new-notification[data-v-6b08a1a0]{animation:highlightPulse-6b08a1a0 2s ease-in-out}@media (max-width: 480px){.notification-item[data-v-6b08a1a0]{--padding-start: 12px;--padding-end: 12px;--inner-padding-end: 12px}.notification-avatar[data-v-6b08a1a0]{width:40px;height:40px;margin-right:12px}.reactions-row[data-v-6b08a1a0]{gap:4px}.reactions-row ion-chip[data-v-6b08a1a0]{height:26px;font-size:.75rem}.notification-meta[data-v-6b08a1a0]{gap:8px;flex-wrap:wrap}}@media (prefers-contrast: high){.notification-item[data-v-6b08a1a0]{border-bottom:2px solid var(--ion-border-color)}.notification-item.unread[data-v-6b08a1a0]{border-left-width:4px}.reactions-row ion-chip[data-v-6b08a1a0]{border:1px solid var(--ion-border-color)}}@media (prefers-reduced-motion: reduce){.notification-item.new-notification[data-v-6b08a1a0]{animation:none}}@supports (padding: max(0px)){.notification-item[data-v-6b08a1a0]{--padding-start: max(16px, env(safe-area-inset-left));--padding-end: max(16px, env(safe-area-inset-right))}}.empty-state .action-button[data-v-6b08a1a0],.error-state .retry-button[data-v-6b08a1a0]{margin-top:16px}.loading-container[data-v-6b08a1a0]{animation:fadeIn-6b08a1a0 .3s ease-out}@keyframes fadeIn-6b08a1a0{0%{opacity:0}to{opacity:1}}\n/*$vite$:1*/",document.head.appendChild(n);var Q={key:0,class:"loading-container"},V={key:1,class:"error-state"},W={key:2,class:"empty-state"},X={class:"preview-text"},Z={key:0,class:"reactions-row"},tt={class:"notification-meta"},at={class:"date"},ot={key:0,class:"comments-count"},nt=r({__name:"NotificationsPage",setup:function(a){var n=localStorage.getItem("parisklegg_token")||"",r=localStorage.getItem("parisklegg_user");r&&JSON.parse(r);var Y=function(t){return{like:J,heart:q,"thumbs-up":U}[t]||J},nt=v(),rt=i(!0),et=i(!1),it=i(!1),ct=i([]),lt=i(1),ut=i(!0),dt=function(){var a=e(t().m(function a(){var r,e,i,c=arguments;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:if(r=c.length>0&&void 0!==c[0]?c[0]:1,t.p=1,1===r?(rt.value=!0,ct.value=[]):et.value=!0,it.value=!1,n){t.n=2;break}throw new Error("No authentication token found");case 2:return t.n=3,f.get("https://klegg-app-whh7m.ondigitalocean.app/api/notifications",{headers:pt(),timeout:1e4,params:{page:r}});case 3:e=t.v,ct.value=1===r?e.data.data:[].concat(o(ct.value),o(e.data.data)),lt.value=r,ut.value=!!e.data.next_page_url,console.log("Notifications fetched successfully:",ct.value),t.n=5;break;case 4:t.p=4,i=t.v,ft(i),it.value=!0;case 5:return t.p=5,rt.value=!1,et.value=!1,t.f(5);case 6:return t.a(2)}},a,null,[[1,4,5,6]])}));return function(){return a.apply(this,arguments)}}(),st=function(){var a=e(t().m(function a(o){return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,dt(lt.value+1);case 1:o.target.complete();case 2:return t.a(2)}},a)}));return function(t){return a.apply(this,arguments)}}();c(e(t().m(function a(){return t().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,dt();case 1:return t.a(2)}},a)})));var pt=function(){return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(n)}},ft=function(t){if(console.error("Error fetching data:",t),f.isAxiosError(t)){var a;if(401===(null===(a=t.response)||void 0===a?void 0:a.status))return nt.replace("/"),void K.show({text:"Session expired. Please login again",position:"top",duration:"long"});if("ECONNABORTED"===t.code)return void K.show({text:"Request timeout. Please try again",position:"top"})}K.show({text:"Failed to load data. Please try again later",position:"top"})},vt=function(t){var a=t.matches;g(a)};return l(function(){var t;t=window.matchMedia("(prefers-color-scheme: dark)"),vt(t),t.addEventListener("change",vt),dt()}),function(t,a){var n=L("ion-chip");return G(),u(s(p),null,{default:d(function(){return[m(s(y),null,{default:d(function(){return[m(s(b),null,{default:d(function(){return[m(s(h),null,{default:d(function(){return o(a[2]||(a[2]=[x("Notifications",-1)]))}),_:1})]}),_:1})]}),_:1}),m(s(C),{fullscreen:!0,onIonScroll:a[1]||(a[1]=function(t){return function(t){var a=t.target;if(a){var o=a.scrollHeight;a.scrollTop+a.clientHeight>.8*o&&ut.value&&!et.value&&dt(lt.value+1)}}(t)})},{default:d(function(){return[rt.value&&!et.value?(G(),w("div",Q,[m(s(_),{name:"crescent",color:"primary"}),a[3]||(a[3]=k("p",null,"Loading notifications...",-1))])):it.value?(G(),w("div",V,[m(s(S),{icon:s(j),color:"danger",size:"large"},null,8,["icon"]),m(s(z),null,{default:d(function(){return o(a[4]||(a[4]=[k("h3",null,"Error Loading Notifications",-1),k("p",null,"Please try again later",-1)]))}),_:1}),m(s(O),{fill:"clear",onClick:dt},{default:d(function(){return o(a[5]||(a[5]=[x("Retry",-1)]))}),_:1})])):0!==ct.value.length||rt.value?(G(),u(s(E),{key:3},{default:d(function(){return[(G(!0),w(N,null,I(ct.value,function(t){return G(),u(s(F),{key:t.id,onClick:function(a){return o=t.id,void nt.push("/notifications/".concat(o));var o},class:"notification-item"},{default:d(function(){return[m(s(R),{slot:"start",class:"notification-avatar"},{default:d(function(){return o(a[7]||(a[7]=[k("img",{src:B,alt:"School Logo"},null,-1)]))}),_:1}),m(s(D),null,{default:d(function(){return[k("h2",null,H(t.title),1),k("p",X,H((o=t.body,r=60,o.length<=r?o:o.substring(0,r)+"...")),1),t.reaction_counts&&Object.keys(t.reaction_counts).length?(G(),w("div",Z,[(G(!0),w(N,null,I(t.reaction_counts,function(t,a){return G(),u(n,{key:a,color:"light",class:"reaction-chip"},{default:d(function(){return[m(s(S),{icon:Y(a)},null,8,["icon"]),m(s(D),null,{default:d(function(){return[x(H(t),1)]}),_:2},1024)]}),_:2},1024)}),128))])):$("",!0),k("div",tt,[k("span",at,H((a=t.created_at,new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}))),1),t.comments_count?(G(),w("span",ot,[m(s(S),{icon:s(M)},null,8,["icon"]),x(" "+H(t.comments_count),1)])):$("",!0)])];var a,o,r}),_:2},1024)]}),_:2},1032,["onClick"])}),128))]}),_:1})):(G(),w("div",W,[m(s(S),{icon:s(P),color:"medium",size:"large"},null,8,["icon"]),m(s(z),null,{default:d(function(){return o(a[6]||(a[6]=[k("h3",null,"No Notifications",-1),k("p",null,"You don't have any notifications yet",-1)]))}),_:1})])),m(s(A),{onIonInfinite:a[0]||(a[0]=function(t){return st(t)}),threshold:"100px",disabled:!ut.value},{default:d(function(){return[m(s(T),{"loading-spinner":"bubbles","loading-text":"Loading more notifications..."})]}),_:1},8,["disabled"])]}),_:1})]}),_:1})}}});a("default",Y(nt,[["__scopeId","data-v-6b08a1a0"]]))}}})}();
