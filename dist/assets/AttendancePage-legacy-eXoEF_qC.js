!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.toStringTag||"@@toStringTag";function i(n,r,o,c){var i=r&&r.prototype instanceof l?r:l,s=Object.create(i.prototype);return a(s,"_invoke",function(n,a,r){var o,c,i,l=0,s=r||[],d=!1,f={p:0,n:0,v:t,a:m,f:m.bind(t,4),d:function(e,n){return o=e,c=0,i=t,f.n=n,u}};function m(n,a){for(c=n,i=a,e=0;!d&&l&&!r&&e<s.length;e++){var r,o=s[e],m=f.p,p=o[2];n>3?(r=p===a)&&(i=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=t):o[0]<=m&&((r=n<2&&m<o[1])?(c=0,f.v=a,f.n=o[1]):m<p&&(r=n<3||o[0]>a||a>p)&&(o[4]=n,o[5]=a,f.n=p,c=0))}if(r||n>1)return u;throw d=!0,a}return function(r,s,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===s&&m(s,p),c=s,i=p;(e=c<2?t:i)||!d;){o||(c?c<3?(c>1&&(f.n=-1),m(c,i)):f.n=i:f.v=i);try{if(l=2,o){if(c||(r="next"),e=o[r]){if(!(e=e.call(o,i)))throw TypeError("iterator result is not an object");if(!e.done)return e;i=e.value,c<2&&(c=0)}else 1===c&&(e=o.return)&&e.call(o),c<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),c=1);o=t}else if((e=(d=f.n<0)?i:n.call(a,f))!==u)break}catch(e){o=t,c=1,i=e}finally{l=1}}return{value:e,done:d}}}(n,o,c),!0),s}var u={};function l(){}function s(){}function d(){}e=Object.getPrototypeOf;var f=[][o]?e(e([][o]())):(a(e={},o,function(){return this}),e),m=d.prototype=l.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t}return s.prototype=d,a(m,"constructor",d),a(d,"constructor",s),s.displayName="GeneratorFunction",a(d,c,"GeneratorFunction"),a(m),a(m,c,"Generator"),a(m,o,function(){return this}),a(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:i,m:p}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){function c(e,n){a(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(c("next",0),c("throw",1),c("return",2))},a(t,e,n,r)}function r(t,e,n,a,r,o,c){try{var i=t[o](c),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(a,r)}System.register(["./index-legacy-C3op4-Ni.js","./index-legacy-EE099LYJ.js"],function(e,a){"use strict";var o,c,i,u,l,s,d,f,m,p,v,y,b,g,h,x,_,w,k,A,S,j,C,O,z,P,T,E,L,F,G,I,N,D,R,B,$,M,U,q,J,K,V,W,Y,H,Q,X,Z,tt,et,nt,at,rt,ot,ct;return{setters:[function(t){o=t.d,c=t.ar,i=t.r,u=t.S,l=t.a,s=t.o,d=t.b,f=t.w,m=t.u,p=t.I,v=t.e,y=t.f,b=t.g,g=t.h,h=t.i,x=t.P,_=t.l,w=t.A,k=t.q,A=t.k,S=t.s,j=t.a9,C=t.a3,O=t.t,z=t.x,P=t.C,T=t.n,E=t.at,L=t.au,F=t.v,G=t.J,I=t.a2,N=t.m,D=t.a4,R=t.T,B=t.U,$=t.M,M=t.N,U=t.av,q=t.a7,J=t.$,K=t.K,V=t.aw,W=t.ax,Y=t.ay,H=t.az,Q=t.aA,X=t.aB,Z=t.aC,tt=t.aD,et=t.aE,nt=t.aF,at=t.aG,rt=t.F,ot=t._},function(t){ct=t.T}],execute:function(){var a=document.createElement("style");a.textContent=".header-section[data-v-375c2bc6]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding-bottom:16px}.header-section .title[data-v-375c2bc6]{display:block;font-size:1.5rem;font-weight:600;color:#fff;margin-bottom:16px}.summary-cards[data-v-375c2bc6]{display:flex;gap:16px;margin-top:8px}.summary-card[data-v-375c2bc6]{flex:1;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin:0}.summary-card.present[data-v-375c2bc6]{--background: rgba(var(--ion-color-success-rgb), .1)}.summary-card.absent[data-v-375c2bc6]{--background: rgba(var(--ion-color-danger-rgb), .1)}.summary-content[data-v-375c2bc6]{display:flex;align-items:center;gap:12px}.summary-icon[data-v-375c2bc6]{font-size:32px}.summary-card.present .summary-icon[data-v-375c2bc6]{color:var(--ion-color-success)}.summary-card.absent .summary-icon[data-v-375c2bc6]{color:var(--ion-color-danger)}.summary-count[data-v-375c2bc6]{font-size:1.5rem;font-weight:700;display:block;line-height:1.2;color:var(--ion-color-light)}.summary-label[data-v-375c2bc6]{font-size:.875rem;opacity:.8;display:block;color:var(--ion-color-light)}.bal-text-color[data-v-375c2bc6]{color:var(--ion-text-color);white-space:pre-line}.loading-container[data-v-375c2bc6]{display:flex;justify-content:center;align-items:center;height:200px}.empty-state[data-v-375c2bc6],.error-state[data-v-375c2bc6]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:60vh;padding:20px}.empty-state ion-icon[data-v-375c2bc6],.error-state ion-icon[data-v-375c2bc6]{font-size:64px;margin-bottom:16px}.empty-state h3[data-v-375c2bc6],.error-state h3[data-v-375c2bc6]{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--ion-color-dark)}.empty-state p[data-v-375c2bc6],.error-state p[data-v-375c2bc6]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:16px}.status-indicator[data-v-375c2bc6]{width:4px;height:100%;border-radius:4px;position:absolute;left:0}.attendance-item[data-v-375c2bc6]{--padding-start: 12px;--inner-padding-end: 12px;--background: var(--ion-item-background, var(--ion-background-color, #fff));margin-bottom:8px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.08)}.attendance-content[data-v-375c2bc6]{margin-left:12px}.attendance-header[data-v-375c2bc6]{display:flex;justify-content:space-between;margin-bottom:8px}.attendance-status[data-v-375c2bc6]{font-weight:600;font-size:.9rem}.attendance-date[data-v-375c2bc6]{font-size:.8rem;color:var(--ion-color-medium)}.attendance-details[data-v-375c2bc6]{font-size:.875rem;color:var(--ion-color-medium)}.detail-row[data-v-375c2bc6]{display:flex;align-items:center;margin-bottom:4px}.detail-row ion-icon[data-v-375c2bc6]{margin-right:8px;font-size:16px;min-width:20px}.attendance-icon[data-v-375c2bc6]{font-size:24px}@media (min-width: 768px){.summary-cards[data-v-375c2bc6]{gap:24px}.attendance-item[data-v-375c2bc6]{margin:0 auto 12px;max-width:800px}}\n/*$vite$:1*/",document.head.appendChild(a);var it={class:"header-section ion-padding"},ut={class:"summary-cards"},lt={class:"summary-content"},st={class:"summary-content"},dt={key:0,class:"loading-container"},ft={key:1,class:"empty-state"},mt={key:2,class:"error-state"},pt={key:3},vt={class:"attendance-header"},yt={class:"attendance-details"},bt={class:"detail-row"},gt={class:"detail-row"},ht={key:0,class:"detail-row"},xt={key:1,class:"detail-row"},_t={slot:"end",class:"attendance-icon"},wt=o({__name:"AttendancePage",setup:function(e){var a=localStorage.getItem("parisklegg_token")||"",o=localStorage.getItem("parisklegg_user"),ot=o?JSON.parse(o):null,wt=(null==ot?void 0:ot.user_id)||0,kt=c(),At=y(),St=Number(kt.params.id),jt=i(""),Ct=i(!0),Ot=i(!1),zt=i(!1),Pt=i([]),Tt=i(0),Et=i(0),Lt=function(t){switch(null==t?void 0:t.toLowerCase()){case"present":return"var(--ion-color-success)";case"absent":return"var(--ion-color-danger)";case"late":return"var(--ion-color-warning)";case"sick":return"var(--ion-color-primary)";default:return"var(--ion-color-medium)"}},Ft=function(t){switch(null==t?void 0:t.toLowerCase()){case"present":return rt;case"absent":return at;case"late":return nt;case"sick":return et;default:return tt}},Gt=function(t){switch(null==t?void 0:t.toLowerCase()){case"present":return"success";case"absent":return"danger";case"late":return"warning";case"sick":return"primary";default:return"medium"}},It=function(){var t,e=(t=n().m(function t(){var e,a,r;return n().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,Ct.value=!0,Ot.value=!1,Pt.value=[],Tt.value=0,Et.value=0,t.n=1,v.get("https://klegg-app-whh7m.ondigitalocean.app/api/attendances",{headers:Nt(),timeout:2e4});case 1:e=t.v,a=e.data.filter(function(t){return t.tutorship_id===St&&t.user_id===wt}),console.log("Filtered user attendance records:",a),a.length>0&&(zt.value=!0,jt.value=a[0].tutorship_name||"My Attendance",a.forEach(function(t){"present"===t.student_attendance.toLowerCase()?Tt.value++:"absent"===t.student_attendance.toLowerCase()&&Et.value++}),Pt.value=a.sort(function(t,e){return new Date(e.attendance_date||e.created_at).getTime()-new Date(t.attendance_date||t.created_at).getTime()})),t.n=3;break;case 2:t.p=2,r=t.v,Dt(r),Ot.value=!0;case 3:return t.p=3,Ct.value=!1,t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}),function(){var e=this,n=arguments;return new Promise(function(a,o){var c=t.apply(e,n);function i(t){r(c,a,o,i,u,"next",t)}function u(t){r(c,a,o,i,u,"throw",t)}i(void 0)})});return function(){return e.apply(this,arguments)}}(),Nt=function(){return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(a)}},Dt=function(t){if(console.error("Error fetching data:",t),v.isAxiosError(t)){var e;if(401===(null===(e=t.response)||void 0===e?void 0:e.status))return At.replace("/"),void ct.show({text:"Session expired. Please login again",position:"top",duration:"long"});if("ECONNABORTED"===t.code)return void ct.show({text:"Request timeout. Please try again",position:"top"})}ct.show({text:"Failed to load data. Please try again later",position:"top"})};return u.setOverlaysWebView({overlay:!1}),u.setBackgroundColor({color:"#ffffff"}),u.setStyle({style:l.Light}),s(function(){It()}),function(e,n){return M(),d(m(p),null,{default:f(function(){return[b(m(k),null,{default:f(function(){return[b(m(g),null,{default:f(function(){return[b(m(h),{slot:"start"},{default:f(function(){return[b(m(x),{"default-href":"/"})]}),_:1}),b(m(_),null,{default:f(function(){return t(n[0]||(n[0]=[w("Attendance",-1)]))}),_:1})]}),_:1})]}),_:1}),b(m($),{fullscreen:!0},{default:f(function(){return[A("div",it,[jt.value?(M(),d(m(C),{key:0,class:"title"},{default:f(function(){return[w(O(jt.value),1)]}),_:1})):j("",!0),A("div",ut,[b(m(z),{class:"summary-card present"},{default:f(function(){return[b(m(P),null,{default:f(function(){return[A("div",lt,[b(m(T),{icon:m(E),class:"summary-icon"},null,8,["icon"]),A("div",null,[b(m(C),{class:"summary-count"},{default:f(function(){return[w(O(Tt.value),1)]}),_:1}),b(m(C),{class:"summary-label"},{default:f(function(){return t(n[1]||(n[1]=[w("Present",-1)]))}),_:1})])])]}),_:1})]}),_:1}),b(m(z),{class:"summary-card absent"},{default:f(function(){return[b(m(P),null,{default:f(function(){return[A("div",st,[b(m(T),{icon:m(L),class:"summary-icon"},null,8,["icon"]),A("div",null,[b(m(C),{class:"summary-count"},{default:f(function(){return[w(O(Et.value),1)]}),_:1}),b(m(C),{class:"summary-label"},{default:f(function(){return t(n[2]||(n[2]=[w("Absent",-1)]))}),_:1})])])]}),_:1})]}),_:1})])]),Ct.value?(M(),S("div",dt,[b(m(F),{name:"crescent",color:"primary"})])):zt.value||Ot.value?Ot.value?(M(),S("div",mt,[b(m(T),{icon:m(I),color:"danger"},null,8,["icon"]),b(m(C),null,{default:f(function(){return t(n[4]||(n[4]=[A("h3",null,"Error Loading Attendance",-1),A("p",null,"Please try again later",-1)]))}),_:1}),b(m(N),{fill:"clear",onClick:It},{default:f(function(){return t(n[5]||(n[5]=[w("Retry",-1)]))}),_:1})])):(M(),S("div",pt,[b(m(D),{lines:"none"},{default:f(function(){return[(M(!0),S(R,null,B(Pt.value,function(t,e){return M(),d(m(U),{key:e},{default:f(function(){return[b(m(q),{class:"attendance-item",detail:!1},{default:f(function(){return[A("div",{slot:"start",class:"status-indicator",style:J({backgroundColor:Lt(t.student_attendance)})},null,4),b(m(K),{class:"attendance-content"},{default:f(function(){return[A("div",vt,[b(m(C),{class:"attendance-status",style:J({color:Lt(t.student_attendance)})},{default:f(function(){return[w(O(t.student_attendance),1)]}),_:2},1032,["style"]),b(m(C),{class:"attendance-date bal-text-color"},{default:f(function(){return[w(O((e=t.attendance_date||t.created_at,new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),1)];var e}),_:2},1024)]),A("div",yt,[A("div",bt,[b(m(T),{icon:m(V)},null,8,["icon"]),b(m(C),{class:"bal-text-color"},{default:f(function(){return[w(O(t.student_name),1)]}),_:2},1024)]),A("div",gt,[b(m(T),{icon:m(W)},null,8,["icon"]),b(m(C),{class:"bal-text-color"},{default:f(function(){return[w(O(t.teacher_name),1)]}),_:2},1024)]),t.attendance_code?(M(),S("div",ht,[b(m(T),{icon:m(Y)},null,8,["icon"]),b(m(C),{class:"bal-text-color"},{default:f(function(){return[w("Code: "+O(t.attendance_code),1)]}),_:2},1024)])):j("",!0),t.remark?(M(),S("div",xt,[b(m(T),{icon:m(H)},null,8,["icon"]),b(m(C),{class:"bal-text-color"},{default:f(function(){return[w(O(t.remark),1)]}),_:2},1024)])):j("",!0)])]}),_:2},1024),A("div",_t,[b(m(T),{icon:Ft(t.student_attendance),color:Gt(t.student_attendance)},null,8,["icon","color"])])]}),_:2},1024),b(m(Q),{side:"end"},{default:f(function(){return[b(m(X),{color:"danger",onClick:function(e){return function(t){console.log("Reporting issue for record:",t)}(t)}},{default:f(function(){return[b(m(T),{slot:"icon-only",icon:m(Z)},null,8,["icon"])]}),_:1},8,["onClick"])]}),_:2},1024)]}),_:2},1024)}),128))]}),_:1})])):(M(),S("div",ft,[b(m(T),{icon:m(G),color:"medium"},null,8,["icon"]),b(m(C),null,{default:f(function(){return t(n[3]||(n[3]=[A("h3",null,"No Attendance Records",-1),A("p",null,"Your attendance will appear here when marked by your teacher",-1)]))}),_:1})]))]}),_:1})]}),_:1})}}});e("default",ot(wt,[["__scopeId","data-v-375c2bc6"]]))}}})}();
