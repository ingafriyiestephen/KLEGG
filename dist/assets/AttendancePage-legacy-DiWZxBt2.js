System.register(["./index-legacy-LZepmReL.js","./index-legacy-DduMCVS-.js"],function(a,e){"use strict";var t,n,r,o,l,d,s,i,c,u,m,f,v,p,g,y,b,_,h,x,w,k,C,z,A,S,L,j,E,P,D,N,T,R,B,I,O,q,F,J,M,U,$,K,V,W,Y,G,H,Q,X,Z,aa,ea,ta,na;return{setters:[a=>{t=a.d,n=a.ao,r=a.r,o=a.S,l=a.a,d=a.o,s=a.b,i=a.w,c=a.u,u=a.I,m=a.e,f=a.f,v=a.g,p=a.h,g=a.i,y=a.P,b=a.l,_=a.A,h=a.q,x=a.k,w=a.s,k=a.a9,C=a.a3,z=a.t,A=a.x,S=a.C,L=a.n,j=a.aq,E=a.ar,P=a.v,D=a.J,N=a.a2,T=a.m,R=a.a4,B=a.T,I=a.U,O=a.M,q=a.N,F=a.as,J=a.a7,M=a.$,U=a.K,$=a.at,K=a.au,V=a.av,W=a.aw,Y=a.ax,G=a.ay,H=a.az,Q=a.aA,X=a.aB,Z=a.aC,aa=a.aD,ea=a.F,ta=a._},a=>{na=a.T}],execute:function(){var e=document.createElement("style");e.textContent=".header-section[data-v-7d690fba]{background:linear-gradient(135deg,var(--ion-color-primary) 0%,var(--ion-color-secondary) 100%);color:#fff;padding-bottom:16px}.header-section .title[data-v-7d690fba]{display:block;font-size:1.5rem;font-weight:600;color:#fff;margin-bottom:16px}.summary-cards[data-v-7d690fba]{display:flex;gap:16px;margin-top:8px}.summary-card[data-v-7d690fba]{flex:1;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);margin:0}.summary-card.present[data-v-7d690fba]{--background: rgba(var(--ion-color-success-rgb), .1)}.summary-card.absent[data-v-7d690fba]{--background: rgba(var(--ion-color-danger-rgb), .1)}.summary-content[data-v-7d690fba]{display:flex;align-items:center;gap:12px}.summary-icon[data-v-7d690fba]{font-size:32px}.summary-card.present .summary-icon[data-v-7d690fba]{color:var(--ion-color-success)}.summary-card.absent .summary-icon[data-v-7d690fba]{color:var(--ion-color-danger)}.summary-count[data-v-7d690fba]{font-size:1.5rem;font-weight:700;display:block;line-height:1.2;color:var(--ion-color-light)}.summary-label[data-v-7d690fba]{font-size:.875rem;opacity:.8;display:block;color:var(--ion-color-light)}.loading-container[data-v-7d690fba]{display:flex;justify-content:center;align-items:center;height:200px}.empty-state[data-v-7d690fba],.error-state[data-v-7d690fba]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:60vh;padding:20px}.empty-state ion-icon[data-v-7d690fba],.error-state ion-icon[data-v-7d690fba]{font-size:64px;margin-bottom:16px}.empty-state h3[data-v-7d690fba],.error-state h3[data-v-7d690fba]{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--ion-color-dark)}.empty-state p[data-v-7d690fba],.error-state p[data-v-7d690fba]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:16px}.status-indicator[data-v-7d690fba]{width:4px;height:100%;border-radius:4px;position:absolute;left:0}.attendance-item[data-v-7d690fba]{--padding-start: 12px;--inner-padding-end: 12px;--background: var(--ion-item-background, var(--ion-background-color, #fff));margin-bottom:8px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.08)}.attendance-content[data-v-7d690fba]{margin-left:12px}.attendance-header[data-v-7d690fba]{display:flex;justify-content:space-between;margin-bottom:8px}.attendance-status[data-v-7d690fba]{font-weight:600;font-size:.9rem}.attendance-date[data-v-7d690fba]{font-size:.8rem;color:var(--ion-color-medium)}.attendance-details[data-v-7d690fba]{font-size:.875rem;color:var(--ion-color-medium)}.detail-row[data-v-7d690fba]{display:flex;align-items:center;margin-bottom:4px}.detail-row ion-icon[data-v-7d690fba]{margin-right:8px;font-size:16px;min-width:20px}.attendance-icon[data-v-7d690fba]{font-size:24px}@media (min-width: 768px){.summary-cards[data-v-7d690fba]{gap:24px}.attendance-item[data-v-7d690fba]{margin:0 auto 12px;max-width:800px}}\n",document.head.appendChild(e);const ra={class:"header-section ion-padding"},oa={class:"summary-cards"},la={class:"summary-content"},da={class:"summary-content"},sa={key:0,class:"loading-container"},ia={key:1,class:"empty-state"},ca={key:2,class:"error-state"},ua={key:3},ma={class:"attendance-header"},fa={class:"attendance-details"},va={class:"detail-row"},pa={class:"detail-row"},ga={key:0,class:"detail-row"},ya={key:1,class:"detail-row"},ba={slot:"end",class:"attendance-icon"};a("default",ta(t({__name:"AttendancePage",setup(a){const e=localStorage.getItem("parisklegg_token")||"",t=localStorage.getItem("parisklegg_user"),ta=t?JSON.parse(t):null,_a=(null==ta?void 0:ta.user_id)||0,ha=n(),xa=f(),wa=Number(ha.params.id),ka=r(""),Ca=r(!0),za=r(!1),Aa=r(!1),Sa=r([]),La=r(0),ja=r(0),Ea=a=>{switch(null==a?void 0:a.toLowerCase()){case"present":return"var(--ion-color-success)";case"absent":return"var(--ion-color-danger)";case"late":return"var(--ion-color-warning)";case"sick":return"var(--ion-color-primary)";default:return"var(--ion-color-medium)"}},Pa=a=>{switch(null==a?void 0:a.toLowerCase()){case"present":return ea;case"absent":return aa;case"late":return Z;case"sick":return X;default:return Q}},Da=a=>{switch(null==a?void 0:a.toLowerCase()){case"present":return"success";case"absent":return"danger";case"late":return"warning";case"sick":return"primary";default:return"medium"}},Na=async()=>{try{Ca.value=!0,za.value=!1,Sa.value=[],La.value=0,ja.value=0;const a=(await m.get("https://school.klgilc.com/api/attendances",{headers:Ta(),timeout:2e4})).data.filter(a=>a.tutorship_id===wa&&a.user_id===_a);console.log("Filtered user attendance records:",a),a.length>0&&(Aa.value=!0,ka.value=a[0].tutorship_name||"My Attendance",a.forEach(a=>{"present"===a.student_attendance.toLowerCase()?La.value++:"absent"===a.student_attendance.toLowerCase()&&ja.value++}),Sa.value=a.sort((a,e)=>new Date(e.attendance_date||e.created_at).getTime()-new Date(a.attendance_date||a.created_at).getTime()))}catch(a){Ra(a),za.value=!0}finally{Ca.value=!1}},Ta=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e}`}),Ra=a=>{if(console.error("Error fetching data:",a),m.isAxiosError(a)){var e;if(401===(null===(e=a.response)||void 0===e?void 0:e.status))return xa.replace("/"),void na.show({text:"Session expired. Please login again",position:"top",duration:"long"});if("ECONNABORTED"===a.code)return void na.show({text:"Request timeout. Please try again",position:"top"})}na.show({text:"Failed to load data. Please try again later",position:"top"})};return o.setOverlaysWebView({overlay:!1}),o.setBackgroundColor({color:"#ffffff"}),o.setStyle({style:l.Light}),d(()=>{Na()}),(a,e)=>(q(),s(c(u),null,{default:i(()=>[v(c(h),null,{default:i(()=>[v(c(p),null,{default:i(()=>[v(c(g),{slot:"start"},{default:i(()=>[v(c(y),{"default-href":"/"})]),_:1}),v(c(b),null,{default:i(()=>e[0]||(e[0]=[_("Attendance",-1)])),_:1,__:[0]})]),_:1})]),_:1}),v(c(O),{fullscreen:!0},{default:i(()=>[x("div",ra,[ka.value?(q(),s(c(C),{key:0,class:"title"},{default:i(()=>[_(z(ka.value),1)]),_:1})):k("",!0),x("div",oa,[v(c(A),{class:"summary-card present"},{default:i(()=>[v(c(S),null,{default:i(()=>[x("div",la,[v(c(L),{icon:c(j),class:"summary-icon"},null,8,["icon"]),x("div",null,[v(c(C),{class:"summary-count"},{default:i(()=>[_(z(La.value),1)]),_:1}),v(c(C),{class:"summary-label"},{default:i(()=>e[1]||(e[1]=[_("Present",-1)])),_:1,__:[1]})])])]),_:1})]),_:1}),v(c(A),{class:"summary-card absent"},{default:i(()=>[v(c(S),null,{default:i(()=>[x("div",da,[v(c(L),{icon:c(E),class:"summary-icon"},null,8,["icon"]),x("div",null,[v(c(C),{class:"summary-count"},{default:i(()=>[_(z(ja.value),1)]),_:1}),v(c(C),{class:"summary-label"},{default:i(()=>e[2]||(e[2]=[_("Absent",-1)])),_:1,__:[2]})])])]),_:1})]),_:1})])]),Ca.value?(q(),w("div",sa,[v(c(P),{name:"crescent",color:"primary"})])):Aa.value||za.value?za.value?(q(),w("div",ca,[v(c(L),{icon:c(N),color:"danger"},null,8,["icon"]),v(c(C),null,{default:i(()=>e[4]||(e[4]=[x("h3",null,"Error Loading Attendance",-1),x("p",null,"Please try again later",-1)])),_:1,__:[4]}),v(c(T),{fill:"clear",onClick:Na},{default:i(()=>e[5]||(e[5]=[_("Retry",-1)])),_:1,__:[5]})])):(q(),w("div",ua,[v(c(R),{lines:"none"},{default:i(()=>[(q(!0),w(B,null,I(Sa.value,(a,e)=>(q(),s(c(F),{key:e},{default:i(()=>[v(c(J),{class:"attendance-item",detail:!1},{default:i(()=>[x("div",{slot:"start",class:"status-indicator",style:M({backgroundColor:Ea(a.student_attendance)})},null,4),v(c(U),{class:"attendance-content"},{default:i(()=>[x("div",ma,[v(c(C),{class:"attendance-status",style:M({color:Ea(a.student_attendance)})},{default:i(()=>[_(z(a.student_attendance),1)]),_:2},1032,["style"]),v(c(C),{class:"attendance-date"},{default:i(()=>{return[_(z((e=a.attendance_date||a.created_at,new Date(e).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),1)];var e}),_:2},1024)]),x("div",fa,[x("div",va,[v(c(L),{icon:c($)},null,8,["icon"]),v(c(C),null,{default:i(()=>[_(z(a.student_name),1)]),_:2},1024)]),x("div",pa,[v(c(L),{icon:c(K)},null,8,["icon"]),v(c(C),null,{default:i(()=>[_(z(a.teacher_name),1)]),_:2},1024)]),a.attendance_code?(q(),w("div",ga,[v(c(L),{icon:c(V)},null,8,["icon"]),v(c(C),null,{default:i(()=>[_("Code: "+z(a.attendance_code),1)]),_:2},1024)])):k("",!0),a.remark?(q(),w("div",ya,[v(c(L),{icon:c(W)},null,8,["icon"]),v(c(C),null,{default:i(()=>[_(z(a.remark),1)]),_:2},1024)])):k("",!0)])]),_:2},1024),x("div",ba,[v(c(L),{icon:Pa(a.student_attendance),color:Da(a.student_attendance)},null,8,["icon","color"])])]),_:2},1024),v(c(Y),{side:"end"},{default:i(()=>[v(c(G),{color:"danger",onClick:e=>(a=>{console.log("Reporting issue for record:",a)})(a)},{default:i(()=>[v(c(L),{slot:"icon-only",icon:c(H)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(q(),w("div",ia,[v(c(L),{icon:c(D),color:"medium"},null,8,["icon"]),v(c(C),null,{default:i(()=>e[3]||(e[3]=[x("h3",null,"No Attendance Records",-1),x("p",null,"Your attendance will appear here when marked by your teacher",-1)])),_:1,__:[3]})]))]),_:1})]),_:1}))}}),[["__scopeId","data-v-7d690fba"]]))}}});
