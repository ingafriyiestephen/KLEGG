import{d as j,ao as F,r as y,c as I,o as q,P as J,a as k,w as n,u as e,I as U,b as T,e as W,f as Y,g as a,h as K,j as Q,aq as X,m as Z,B as r,s as ee,v as g,y as te,z as ae,A as se,p as m,aN as ne,D as oe,l,a2 as i,t as d,V as re,x as le,az as ie,a1 as ue,n as de,a3 as ce,S as me,R as fe,N as ge,O as c,av as pe,a6 as _e,aO as ve,a8 as he,ar as ye,aA as Ie,aB as ke,ak as Ce,_ as Se}from"./index-D6yZBIDx.js";import{T as C}from"./index-D-N4iO5a.js";const we={class:"summary-item"},Ae={class:"summary-item"},xe={key:0,class:"loading-container"},Be={key:1,class:"empty-state"},Oe={key:2,class:"error-state"},Te={class:"assessment-header"},Pe={class:"assessment-meta"},De=j({__name:"AssessmentPage",setup(Ee){const P=localStorage.getItem("parisklegg_token")||"",S=localStorage.getItem("parisklegg_user"),p=S?JSON.parse(S):null,D=(p==null?void 0:p.user_id)||0,E=F(),N=W(),b=Number(E.params.id),_=y(!0),f=y(!1),u=y([]),z=I(()=>u.value.length>0),L=I(()=>u.value.length),w=I(()=>{if(u.value.length===0)return 0;const t=u.value.reduce((s,o)=>s+v(o),0);return Math.round(t/u.value.length)}),v=t=>t.score_denominator===0?0:Math.round(t.score_numerator/t.score_denominator*100),R=t=>t>=85?"excellent":t>=70?"good":t>=50?"average":"poor",V=t=>t>=85?"success":t>=70?"primary":t>=50?"warning":"danger",G=t=>{const s=new Date(t),o=s.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),h=s.getHours().toString().padStart(2,"0"),O=s.getMinutes().toString().padStart(2,"0");return"".concat(o,", ").concat(h,":").concat(O)},A=async()=>{try{_.value=!0,f.value=!1,u.value=[];const t=await T.post("https://klegg-app-whh7m.ondigitalocean.app/api/marks",{tutorship_id:b,student_id:D},{headers:$(),timeout:2e4});u.value=t.data}catch(t){console.error("Error fetching assessments:",t),H(t),f.value=!0}finally{_.value=!1}},M=t=>{console.log("Viewing details for:",t)},$=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(P)}),H=t=>{var s;if(console.error("Error fetching data:",t),T.isAxiosError(t)){if(((s=t.response)==null?void 0:s.status)===401){N.replace("/"),C.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(t.code==="ECONNABORTED"){C.show({text:"Request timeout. Please try again",position:"top"});return}}C.show({text:"Failed to load data. Please try again later",position:"top"})},x=t=>{const s=t.matches;Y(s)},B=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)");return x(t),t.addEventListener("change",x),t};return q(()=>{B(),A()}),J(async()=>{B()}),(t,s)=>(c(),k(e(U),null,{default:n(()=>[a(e(ee),null,{default:n(()=>[a(e(K),null,{default:n(()=>[a(e(Q),{slot:"start"},{default:n(()=>[a(e(X),{"default-href":"/"})]),_:1}),a(e(Z),null,{default:n(()=>[...s[0]||(s[0]=[r("Assessment",-1)])]),_:1})]),_:1})]),_:1}),a(e(ge),{fullscreen:!0},{default:n(()=>[a(e(te),{class:"summary-card"},{default:n(()=>[a(e(ae),null,{default:n(()=>[a(e(se),{class:"summary-title"},{default:n(()=>[a(e(m),{icon:e(ne),color:"primary"},null,8,["icon"]),s[1]||(s[1]=r(" Overall Performance ",-1))]),_:1})]),_:1}),a(e(oe),{class:"summary-content"},{default:n(()=>[l("div",we,[a(e(i),{class:"summary-label"},{default:n(()=>[...s[2]||(s[2]=[r("Assignments Graded",-1)])]),_:1}),a(e(i),{class:"summary-value"},{default:n(()=>[r(d(L.value),1)]),_:1})]),s[4]||(s[4]=l("div",{class:"divider"},null,-1)),l("div",Ae,[a(e(i),{class:"summary-label"},{default:n(()=>[...s[3]||(s[3]=[r("Average Score",-1)])]),_:1}),a(e(i),{class:re(["summary-value",R(w.value)])},{default:n(()=>[r(d(w.value)+"% ",1)]),_:1},8,["class"])])]),_:1})]),_:1}),_.value?(c(),g("div",xe,[a(e(le),{name:"crescent",color:"primary"})])):!z.value&&!f.value?(c(),g("div",Be,[a(e(m),{icon:e(ie),size:"large",color:"medium"},null,8,["icon"]),a(e(i),null,{default:n(()=>[...s[5]||(s[5]=[l("h3",null,"No Grades Available",-1),l("p",null,"Your grades will appear here once they're posted",-1)])]),_:1})])):f.value?(c(),g("div",Oe,[a(e(m),{icon:e(ue),size:"large",color:"danger"},null,8,["icon"]),a(e(i),null,{default:n(()=>[...s[6]||(s[6]=[l("h3",null,"Error Loading Grades",-1),l("p",null,"Please try again later",-1)])]),_:1}),a(e(de),{fill:"clear",onClick:A},{default:n(()=>[...s[7]||(s[7]=[r("Retry",-1)])]),_:1})])):(c(),k(e(ce),{key:3,lines:"none"},{default:n(()=>[(c(!0),g(fe,null,me(u.value,(o,h)=>(c(),k(e(pe),{key:h},{default:n(()=>[a(e(_e),{class:"assessment-item"},{default:n(()=>[a(e(m),{slot:"start",icon:e(ve),color:"primary"},null,8,["icon"]),a(e(he),{class:"assessment-content"},{default:n(()=>[l("div",Te,[a(e(i),{class:"assessment-title"},{default:n(()=>[r(d(o.assignment_name||"Assignment"),1)]),_:2},1024),a(e(ye),{color:V(v(o))},{default:n(()=>[r(d(v(o))+"% ",1)]),_:2},1032,["color"])]),l("div",Pe,[a(e(i),{class:"assessment-score"},{default:n(()=>[r(d(o.score_numerator)+"/"+d(o.score_denominator),1)]),_:2},1024),a(e(i),{class:"assessment-date"},{default:n(()=>[r(d(G(o.created_at)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024),a(e(Ie),{side:"end"},{default:n(()=>[a(e(ke),{color:"tertiary",onClick:O=>M(o)},{default:n(()=>[a(e(m),{slot:"icon-only",icon:e(Ce)},null,8,["icon"])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}))}}),ze=Se(De,[["__scopeId","data-v-b4da8244"]]);export{ze as default};
