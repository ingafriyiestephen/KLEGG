import{d as K,r as w,c as v,S as C,a as Q,o as U,b as W,w as o,u as t,I as X,e as T,f as Z,g as e,h as tt,i as H,j as et,k as s,l as nt,t as c,m as d,n as i,p as ot,q as at,s as u,v as st,x as b,y as N,z as S,A as l,B as P,C as A,D as q,E as lt,F as it,G as rt,H as ct,J as ut,K as D,L as dt,M as ft,N as r,_ as _t}from"./index-6dl2zJ1O.js";import{T as f}from"./index-fbeSVdeg.js";const gt=["src"],pt={class:"greeting"},vt={class:"student-name"},yt={key:0,class:"loading-container"},mt={key:1},ht={key:0,class:"notification-content"},kt={key:1,class:"empty-state"},It={key:0,class:"attendance-content"},wt={key:1,class:"empty-state"},Ct={class:"quick-actions-grid"},Tt={class:"action-icon"},bt={class:"action-icon"},Nt={class:"action-icon"},St=K({__name:"HomePage",setup(At){const M=localStorage.getItem("parisklegg_token")||"",O=localStorage.getItem("parisklegg_user"),y=O?JSON.parse(O):null,V=(y==null?void 0:y.fullname)||"",_=Z(),g=w(!0),m=w([]),h=w([]),z=v(()=>{const a=new Date().getHours();return a<12?"Good Morning":a<18?"Good Afternoon":"Good Evening"}),k=v(()=>m.value.length>0?m.value[0]:null),I=v(()=>h.value.length>0?h.value[0]:null),G=v(()=>"/assets/img/login-logo.png"),x=a=>{const n=new Date(a),$=Math.abs(new Date().getTime()-n.getTime()),p=Math.floor($/(1e3*60*60*24));return p===0?"Today":p===1?"Yesterday":p<7?"".concat(p," days ago"):n.toLocaleDateString()},L=(a,n)=>a?a.length>n?a.substring(0,n)+"...":a:"",j=()=>_.push("/tutorships"),B=()=>_.push("/notifications"),F=()=>_.push("/settings"),J=async()=>{g.value=!0;try{await R(),await f.show({text:"Data refreshed",position:"top"})}catch(a){console.error("Refresh error:",a),await f.show({text:"Refresh failed",position:"top"})}finally{g.value=!1}},R=async()=>{try{const[a,n]=await Promise.all([T.get("https://school.klgilc.com/api/notifications",{headers:E()}),T.get("https://school.klgilc.com/api/attendances",{headers:E()})]);m.value=a.data,h.value=n.data}catch(a){Y(a)}},E=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(M)}),Y=a=>{var n;if(console.error("Error fetching data:",a),T.isAxiosError(a)){if(((n=a.response)==null?void 0:n.status)===401){_.replace("/"),f.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(a.code==="ECONNABORTED"){f.show({text:"Request timeout. Please try again",position:"top"});return}}f.show({text:"Failed to load data. Please try again later",position:"top"})};return C.setOverlaysWebView({overlay:!1}),C.setBackgroundColor({color:"#ffffff"}),C.setStyle({style:Q.Light}),U(async()=>{try{await R()}catch(a){console.error("Initialization error:",a)}finally{g.value=!1}}),(a,n)=>(r(),W(t(X),null,{default:o(()=>[e(t(at),{class:"ion-no-border"},{default:o(()=>[e(t(tt),null,{default:o(()=>[e(t(H),{slot:"start"},{default:o(()=>[e(t(et),{class:"toolbar-avatar"},{default:o(()=>[s("img",{src:G.value,alt:"Student"},null,8,gt)]),_:1})]),_:1}),e(t(nt),{class:"toolbar-title"},{default:o(()=>[s("div",pt,c(z.value),1),s("div",vt,c(t(V)),1)]),_:1}),e(t(H),{slot:"end"},{default:o(()=>[e(t(d),{onClick:J,fill:"clear"},{default:o(()=>[e(t(i),{icon:t(ot),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(t(ft),{fullscreen:!0},{default:o(()=>[g.value?(r(),u("div",yt,[e(t(st),{name:"crescent"}),n[0]||(n[0]=s("p",null,"Loading your data...",-1))])):(r(),u("div",mt,[e(t(b),{class:"content-card"},{default:o(()=>[e(t(N),null,{default:o(()=>[e(t(S),null,{default:o(()=>[e(t(i),{icon:t(P)},null,8,["icon"]),n[1]||(n[1]=l(" Recent Updates ",-1))]),_:1,__:[1]})]),_:1}),e(t(A),null,{default:o(()=>[k.value?(r(),u("div",ht,[s("p",null,c(L(k.value.notification_body,100)),1),e(t(q),null,{default:o(()=>[l(c(x(k.value.created_at)),1)]),_:1})])):(r(),u("div",kt,[e(t(i),{icon:t(lt)},null,8,["icon"]),n[2]||(n[2]=s("p",null,"No recent updates",-1))])),e(t(d),{expand:"block",fill:"clear",size:"small",onClick:B,class:"view-all-button"},{default:o(()=>n[3]||(n[3]=[l(" View All Notifications ",-1)])),_:1,__:[3]})]),_:1})]),_:1}),e(t(b),{class:"content-card"},{default:o(()=>[e(t(N),null,{default:o(()=>[e(t(S),null,{default:o(()=>[e(t(i),{icon:t(it)},null,8,["icon"]),n[4]||(n[4]=l(" Recent Attendance ",-1))]),_:1,__:[4]})]),_:1}),e(t(A),null,{default:o(()=>[I.value?(r(),u("div",It,[s("p",null,[n[5]||(n[5]=l(" You were marked ",-1)),s("strong",null,c(I.value.student_attendance),1)]),e(t(q),null,{default:o(()=>[l(c(x(I.value.created_at)),1)]),_:1})])):(r(),u("div",wt,[e(t(i),{icon:t(rt)},null,8,["icon"]),n[6]||(n[6]=s("p",null,"No attendance records yet",-1))]))]),_:1})]),_:1}),e(t(b),{class:"content-card"},{default:o(()=>[e(t(N),null,{default:o(()=>[e(t(S),null,{default:o(()=>[e(t(i),{icon:t(ct)},null,8,["icon"]),n[7]||(n[7]=l(" Quick Actions ",-1))]),_:1,__:[7]})]),_:1}),e(t(A),null,{default:o(()=>[s("div",Ct,[e(t(d),{fill:"clear",class:"quick-action-button",onClick:j},{default:o(()=>[s("div",Tt,[e(t(i),{icon:t(ut)},null,8,["icon"])]),e(t(D),null,{default:o(()=>n[8]||(n[8]=[l("Classes",-1)])),_:1,__:[8]})]),_:1}),e(t(d),{fill:"clear",class:"quick-action-button",onClick:B},{default:o(()=>[s("div",bt,[e(t(i),{icon:t(P)},null,8,["icon"])]),e(t(D),null,{default:o(()=>n[9]||(n[9]=[l("Notifications",-1)])),_:1,__:[9]})]),_:1}),e(t(d),{fill:"clear",class:"quick-action-button",onClick:F},{default:o(()=>[s("div",Nt,[e(t(i),{icon:t(dt)},null,8,["icon"])]),e(t(D),null,{default:o(()=>n[10]||(n[10]=[l("Settings",-1)])),_:1,__:[10]})]),_:1})])]),_:1})]),_:1})]))]),_:1})]),_:1}))}}),Bt=_t(St,[["__scopeId","data-v-42e82624"]]);export{Bt as default};
