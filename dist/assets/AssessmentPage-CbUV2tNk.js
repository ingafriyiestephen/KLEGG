import{d as H,ar as F,r as I,c as h,S as k,a as j,o as q,b as C,w as s,u as e,I as U,e as O,f as J,g as t,h as K,i as W,P as X,l as Y,A as r,q as Q,s as _,x as Z,y as ee,z as te,n as m,aN as ae,C as se,k as l,a3 as u,t as d,X as oe,v as ne,az as re,a2 as le,m as ue,a4 as ie,U as de,T as ce,M as me,N as c,av as fe,a7 as _e,aO as ge,K as pe,as as ve,aA as ye,aB as Ie,an as he,_ as ke}from"./index-CnbctnAi.js";import{T as S}from"./index-BqhxRvg4.js";const Ce={class:"summary-item"},Se={class:"summary-item"},Ae={key:0,class:"loading-container"},we={key:1,class:"empty-state"},xe={key:2,class:"error-state"},Be={class:"assessment-header"},Oe={class:"assessment-meta"},Pe=H({__name:"AssessmentPage",setup(Te){const P=localStorage.getItem("parisklegg_token")||"",A=localStorage.getItem("parisklegg_user"),g=A?JSON.parse(A):null,T=(g==null?void 0:g.user_id)||0,N=F(),b=J(),E=Number(N.params.id),p=I(!0),f=I(!1),i=I([]),z=h(()=>i.value.length>0),D=h(()=>i.value.length),w=h(()=>{if(i.value.length===0)return 0;const a=i.value.reduce((o,n)=>o+v(n),0);return Math.round(a/i.value.length)}),v=a=>a.score_denominator===0?0:Math.round(a.score_numerator/a.score_denominator*100),L=a=>a>=85?"excellent":a>=70?"good":a>=50?"average":"poor",G=a=>a>=85?"success":a>=70?"primary":a>=50?"warning":"danger",M=a=>{const o=new Date(a),n=o.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),y=o.getHours().toString().padStart(2,"0"),B=o.getMinutes().toString().padStart(2,"0");return"".concat(n,", ").concat(y,":").concat(B)},x=async()=>{try{p.value=!0,f.value=!1,i.value=[];const a=await O.post("https://klegg-app-whh7m.ondigitalocean.app/api/marks",{tutorship_id:E,student_id:T},{headers:V(),timeout:2e4});i.value=a.data}catch(a){console.error("Error fetching assessments:",a),$(a),f.value=!0}finally{p.value=!1}},R=a=>{console.log("Viewing details for:",a)},V=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(P)}),$=a=>{var o;if(console.error("Error fetching data:",a),O.isAxiosError(a)){if(((o=a.response)==null?void 0:o.status)===401){b.replace("/"),S.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(a.code==="ECONNABORTED"){S.show({text:"Request timeout. Please try again",position:"top"});return}}S.show({text:"Failed to load data. Please try again later",position:"top"})};return k.setOverlaysWebView({overlay:!1}),k.setBackgroundColor({color:"#ffffff"}),k.setStyle({style:j.Light}),q(()=>{x()}),(a,o)=>(c(),C(e(U),null,{default:s(()=>[t(e(Q),null,{default:s(()=>[t(e(K),null,{default:s(()=>[t(e(W),{slot:"start"},{default:s(()=>[t(e(X),{"default-href":"/"})]),_:1}),t(e(Y),null,{default:s(()=>o[0]||(o[0]=[r("Assessment",-1)])),_:1,__:[0]})]),_:1})]),_:1}),t(e(me),{fullscreen:!0},{default:s(()=>[t(e(Z),{class:"summary-card"},{default:s(()=>[t(e(ee),null,{default:s(()=>[t(e(te),{class:"summary-title"},{default:s(()=>[t(e(m),{icon:e(ae),color:"primary"},null,8,["icon"]),o[1]||(o[1]=r(" Overall Performance ",-1))]),_:1,__:[1]})]),_:1}),t(e(se),{class:"summary-content"},{default:s(()=>[l("div",Ce,[t(e(u),{class:"summary-label"},{default:s(()=>o[2]||(o[2]=[r("Assignments Graded",-1)])),_:1,__:[2]}),t(e(u),{class:"summary-value"},{default:s(()=>[r(d(D.value),1)]),_:1})]),o[4]||(o[4]=l("div",{class:"divider"},null,-1)),l("div",Se,[t(e(u),{class:"summary-label"},{default:s(()=>o[3]||(o[3]=[r("Average Score",-1)])),_:1,__:[3]}),t(e(u),{class:oe(["summary-value",L(w.value)])},{default:s(()=>[r(d(w.value)+"% ",1)]),_:1},8,["class"])])]),_:1,__:[4]})]),_:1}),p.value?(c(),_("div",Ae,[t(e(ne),{name:"crescent",color:"primary"})])):!z.value&&!f.value?(c(),_("div",we,[t(e(m),{icon:e(re),size:"large",color:"medium"},null,8,["icon"]),t(e(u),null,{default:s(()=>o[5]||(o[5]=[l("h3",null,"No Grades Available",-1),l("p",null,"Your grades will appear here once they're posted",-1)])),_:1,__:[5]})])):f.value?(c(),_("div",xe,[t(e(m),{icon:e(le),size:"large",color:"danger"},null,8,["icon"]),t(e(u),null,{default:s(()=>o[6]||(o[6]=[l("h3",null,"Error Loading Grades",-1),l("p",null,"Please try again later",-1)])),_:1,__:[6]}),t(e(ue),{fill:"clear",onClick:x},{default:s(()=>o[7]||(o[7]=[r("Retry",-1)])),_:1,__:[7]})])):(c(),C(e(ie),{key:3,lines:"none"},{default:s(()=>[(c(!0),_(ce,null,de(i.value,(n,y)=>(c(),C(e(fe),{key:y},{default:s(()=>[t(e(_e),{class:"assessment-item"},{default:s(()=>[t(e(m),{slot:"start",icon:e(ge),color:"primary"},null,8,["icon"]),t(e(pe),{class:"assessment-content"},{default:s(()=>[l("div",Be,[t(e(u),{class:"assessment-title"},{default:s(()=>[r(d(n.assignment_name||"Assignment"),1)]),_:2},1024),t(e(ve),{color:G(v(n))},{default:s(()=>[r(d(v(n))+"% ",1)]),_:2},1032,["color"])]),l("div",Oe,[t(e(u),{class:"assessment-score"},{default:s(()=>[r(d(n.score_numerator)+"/"+d(n.score_denominator),1)]),_:2},1024),t(e(u),{class:"assessment-date"},{default:s(()=>[r(d(M(n.created_at)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024),t(e(ye),{side:"end"},{default:s(()=>[t(e(Ie),{color:"tertiary",onClick:B=>R(n)},{default:s(()=>[t(e(m),{slot:"icon-only",icon:e(he)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}))}}),Ee=ke(Pe,[["__scopeId","data-v-4fe78e86"]]);export{Ee as default};
