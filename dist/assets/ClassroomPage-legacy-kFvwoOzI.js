!function(){function t(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||i(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,n,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function s(a,o,r,i){var s=o&&o.prototype instanceof l?o:l,u=Object.create(s.prototype);return e(u,"_invoke",function(a,e,o){var r,i,s,l=0,u=o||[],d=!1,m={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(a,e){return r=a,i=0,s=t,m.n=e,c}};function f(a,e){for(i=a,s=e,n=0;!d&&l&&!o&&n<u.length;n++){var o,r=u[n],f=m.p,p=r[2];a>3?(o=p===e)&&(s=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=t):r[0]<=f&&((o=a<2&&f<r[1])?(i=0,m.v=e,m.n=r[1]):f<p&&(o=a<3||r[0]>e||e>p)&&(r[4]=a,r[5]=e,m.n=p,i=0))}if(o||a>1)return c;throw d=!0,e}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,p),i=u,s=p;(n=i<2?t:s)||!d;){r||(i?i<3?(i>1&&(m.n=-1),f(i,s)):m.n=s:m.v=s);try{if(l=2,r){if(i||(o="next"),n=r[o]){if(!(n=n.call(r,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=r.return)&&n.call(r),i<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),i=1);r=t}else if((n=(d=m.n<0)?s:a.call(e,m))!==c)break}catch(n){r=t,i=1,s=n}finally{l=1}}return{value:n,done:d}}}(a,r,i),!0),u}var c={};function l(){}function u(){}function d(){}n=Object.getPrototypeOf;var m=[][r]?n(n([][r]())):(e(n={},r,function(){return this}),n),f=d.prototype=l.prototype=Object.create(m);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,e(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return u.prototype=d,e(f,"constructor",d),e(d,"constructor",u),u.displayName="GeneratorFunction",e(d,i,"GeneratorFunction"),e(f),e(f,i,"Generator"),e(f,r,function(){return this}),e(f,"toString",function(){return"[object Generator]"}),(a=function(){return{w:s,m:p}})()}function e(t,a,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}e=function(t,a,n,o){function i(a,n){e(t,a,function(t){return this._invoke(a,n,t)})}a?r?r(t,a,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[a]=n:(i("next",0),i("throw",1),i("return",2))},e(t,a,n,o)}function n(t,a,e,n,o,r,i){try{var s=t[r](i),c=s.value}catch(t){return void e(t)}s.done?a(c):Promise.resolve(c).then(n,o)}function o(t){return function(){var a=this,e=arguments;return new Promise(function(o,r){var i=t.apply(a,e);function s(t){n(i,o,r,s,c,"next",t)}function c(t){n(i,o,r,s,c,"throw",t)}s(void 0)})}}function r(t,a){return function(t){if(Array.isArray(t))return t}(t)||function(t,a){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,o,r,i,s=[],c=!0,l=!1;try{if(r=(e=e.call(t)).next,0===a){if(Object(e)!==e)return;c=!1}else for(;!(c=(n=r.call(e)).done)&&(s.push(n.value),s.length!==a);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=e.return&&(i=e.return(),Object(i)!==i))return}finally{if(l)throw o}}return s}}(t,a)||i(t,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,a){if(t){if("string"==typeof t)return s(t,a);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,a):void 0}}function s(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,n=Array(a);e<a;e++)n[e]=t[e];return n}System.register(["./index-legacy-C8AAjeca.js","./index-legacy-DhEKgVkm.js"],function(e,n){"use strict";var i,s,c,l,u,d,m,f,p,g,v,y,b,h,x,w,k,T,_,D,j,S,C,J,E,I,M,P,L,O,z,K,A,N,F,G,R,B,Y,$,q,H,U,V,W,Q;return{setters:[function(t){i=t.d,s=t.ao,c=t.r,l=t.o,u=t.P,d=t.ap,m=t.a,f=t.w,p=t.u,g=t.I,v=t.b,y=t.e,b=t.f,h=t.g,x=t.h,w=t.j,k=t.aq,T=t.m,_=t.B,D=t.s,j=t.l,S=t.v,C=t.a9,J=t.a2,E=t.t,I=t.x,M=t.p,P=t.K,L=t.a1,O=t.n,z=t.R,K=t.S,A=t.N,N=t.O,F=t.y,G=t.V,R=t.z,B=t.A,Y=t.ar,$=t.D,q=t.a6,H=t.H,U=t.a8,V=t.as,W=t._},function(t){Q=t.T}],execute:function(){var n=document.createElement("style");n.textContent=".header-section[data-v-72730a9a]{margin-bottom:24px;text-align:center;background:var(--ion-background-color)}.title[data-v-72730a9a]{display:block;font-size:1.5rem;font-weight:600;color:var(--ion-color-primary);margin-bottom:4px}.subtitle[data-v-72730a9a]{font-size:.9rem;color:var(--ion-color-medium)}.loading-container[data-v-72730a9a]{display:flex;justify-content:center;align-items:center;height:200px;background:var(--ion-background-color)}.loading-container ion-spinner[data-v-72730a9a]{color:var(--ion-color-primary)}.empty-state[data-v-72730a9a],.error-state[data-v-72730a9a]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;height:60vh;padding:20px;background:var(--ion-background-color)}.empty-state ion-icon[data-v-72730a9a]{color:var(--ion-color-medium);font-size:64px;margin-bottom:16px;opacity:.7}.error-state ion-icon[data-v-72730a9a]{color:var(--ion-color-danger);font-size:64px;margin-bottom:16px;opacity:.8}.empty-state h3[data-v-72730a9a],.error-state h3[data-v-72730a9a]{font-size:1.2rem;font-weight:500;margin-bottom:8px;color:var(--ion-text-color)}.empty-state p[data-v-72730a9a],.error-state p[data-v-72730a9a]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:16px;line-height:1.4}.timetable-container[data-v-72730a9a]{display:flex;flex-direction:column;gap:16px;padding:16px;background:var(--ion-background-color)}.day-card[data-v-72730a9a]{background:var(--ion-card-background);border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.08);transition:transform .2s ease,box-shadow .2s ease;border-left:4px solid var(--ion-color-primary);border:1px solid var(--ion-border-color)}.today-card[data-v-72730a9a]{border-left:4px solid var(--ion-color-success);background:rgba(var(--ion-color-success-rgb),.05);border-color:rgba(var(--ion-color-success-rgb),.2)}.day-card-header[data-v-72730a9a]{padding:16px;border-bottom:1px solid var(--ion-border-color);background:var(--ion-item-background);border-radius:12px 12px 0 0}.day-title[data-v-72730a9a]{display:flex;align-items:center;justify-content:space-between;font-size:1.1rem;font-weight:600;color:var(--ion-text-color)}.day-date[data-v-72730a9a]{font-size:.8rem;color:var(--ion-color-medium);font-weight:400}.time-content[data-v-72730a9a]{padding:16px;background:var(--ion-card-background);border-radius:0 0 12px 12px}.time-content ion-item[data-v-72730a9a]{--padding-start: 0;--inner-padding-end: 0;--background: transparent;--border-color: var(--ion-border-color);margin-bottom:12px}.time-content ion-item[data-v-72730a9a]:last-child{margin-bottom:0}.time-content ion-icon[data-v-72730a9a]{margin-right:8px;color:var(--ion-color-primary)}.join-section[data-v-72730a9a]{margin-top:16px;padding-top:16px;border-top:1px solid var(--ion-color-step-100)}.join-button[data-v-72730a9a]{margin-bottom:8px}.join-button[data-v-72730a9a]:not(.button-disabled){--box-shadow: 0 4px 12px rgba(var(--ion-color-primary-rgb), .3)}.countdown[data-v-72730a9a]{text-align:center;margin-bottom:8px}.countdown ion-text[data-v-72730a9a]{font-size:.8rem;font-weight:500}.status-message[data-v-72730a9a]{text-align:center}.status-message ion-text[data-v-72730a9a]{font-size:.8rem;font-weight:500}.not-today-message[data-v-72730a9a]{margin-top:16px;padding-top:16px;border-top:1px solid var(--ion-color-step-100);text-align:center}.not-today-message ion-text[data-v-72730a9a]{font-size:.8rem;font-style:italic}@media (min-width: 768px){.timetable-container[data-v-72730a9a]{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;padding:20px;max-width:1200px;margin:0 auto}.day-card[data-v-72730a9a]{margin:0}}@media (min-width: 1024px){.timetable-container[data-v-72730a9a]{grid-template-columns:repeat(3,1fr)}}.day-card[data-v-72730a9a]:active{transform:scale(.98)}.day-card[data-v-72730a9a]:hover{box-shadow:0 6px 16px rgba(0,0,0,.12)}.day-card[data-v-72730a9a]:focus-visible{outline:2px solid var(--ion-color-primary);outline-offset:2px}.join-button[data-v-72730a9a]:focus{--box-shadow: 0 0 0 2px var(--ion-color-primary)}@keyframes fadeIn-72730a9a{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.day-card[data-v-72730a9a]{animation:fadeIn-72730a9a .3s ease-out}.day-card[data-v-72730a9a]:nth-child(odd){animation-delay:.1s}.day-card[data-v-72730a9a]:nth-child(2n){animation-delay:.2s}.no-link-message[data-v-72730a9a]{text-align:center;margin-top:8px}.no-link-message ion-text[data-v-72730a9a]{font-size:.8rem;font-weight:500}\n/*$vite$:1*/",document.head.appendChild(n);var X={class:"header-section"},Z={key:0,class:"loading-container"},tt={key:1,class:"empty-state"},at={key:2,class:"error-state"},et={key:3,class:"timetable-container"},nt={key:0,class:"join-section"},ot={key:0,class:"no-link-message"},rt={key:1,class:"countdown"},it={key:2,class:"status-message"},st={key:1,class:"not-today-message"},ct=i({__name:"ClassroomPage",setup:function(e){var n=localStorage.getItem("parisklegg_token")||"",i=localStorage.getItem("parisklegg_user");i&&JSON.parse(i);var W=s(),ct=y(),lt=Number(W.params.id),ut=c(""),dt=c(""),mt=c(!0),ft=c(!1),pt=c(!1),gt=c([]),vt=null,yt=function(t){return t.classEnded?"Class Ended":t.classInProgress?t.meetingLink?"Join Now":"No Link":t.canJoin?t.meetingLink?"Join Soon":"No Link":"Join Soon"},bt=function(t){return t.classEnded?"medium":t.classInProgress?"success":t.canJoin?"primary":"medium"},ht=function(t){return t.classEnded?"outline":t.classInProgress||t.canJoin?"solid":"outline"},xt=function(t){return t.classEnded?H:t.classInProgress?V:(t.canJoin,H)},wt=function(t){var a=r(t.split(":").map(Number),2),e=a[0],n=a[1],o=new Date;return o.setHours(e,n,0,0),o},kt=function(t,a){var e=new Date;return e>=t&&e<a},Tt=function(t){return new Date>=t},_t=function(t){var a=new Date,e=new Date(t.getTime()-6e5);if(a<e){var n=e.getTime()-a.getTime(),o=Math.floor(n/36e5),r=Math.floor(n%36e5/6e4);return o>0?"".concat(o,"h ").concat(r,"m"):"".concat(r,"m")}return""},Dt=function(t){return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},jt=function(){var t=o(a().m(function t(){var e,n;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,mt.value=!0,ft.value=!1,t.n=1,v.post("https://klegg-app-whh7m.ondigitalocean.app/api/timetable",{tutorship_id:lt},{headers:It(),timeout:2e4});case 1:e=t.v,console.log("Timetable response:",e.data),St(e.data),t.n=3;break;case 2:t.p=2,n=t.v,Mt(n),ft.value=!0;case 3:return t.p=3,mt.value=!1,t.f(3);case 4:return t.a(2)}},t,null,[[0,2,3,4]])}));return function(){return t.apply(this,arguments)}}(),St=function(t){var a=[{name:"Monday",dayKey:"monday"},{name:"Tuesday",dayKey:"tuesday"},{name:"Wednesday",dayKey:"wednesday"},{name:"Thursday",dayKey:"thursday"},{name:"Friday",dayKey:"friday"},{name:"Saturday",dayKey:"saturday"},{name:"Sunday",dayKey:"sunday"}],e=(new Date).getDay(),n=a[0===e?6:e-1].dayKey;gt.value=[],pt.value=!1,t.forEach(function(t){t.tutorship_id===lt&&(ut.value=t.tutorship_name||"My Timetable",a.forEach(function(a){var e=t["".concat(a.dayKey,"_start")],o=t["".concat(a.dayKey,"_end")];if(function(t,a){return!!t&&""!==t.trim()&&!!a&&""!==a.trim()}(e,o)){pt.value=!0;var r=wt(e),i=wt(o),s=a.dayKey===n,c=t["".concat(a.dayKey,"_meeting_link")],l={name:a.name,dayKey:a.dayKey,startTime:e,endTime:o,isToday:s,canJoin:!1,classInProgress:!1,classEnded:!1,startDateTime:r,endDateTime:i,meetingLink:c};s&&Ct(l),gt.value.push(l)}}))}),Jt()},Ct=function(t){if(t.startDateTime&&t.endDateTime){var a=new Date,e=new Date(t.startDateTime.getTime()-6e5);t.canJoin=!1,t.classInProgress=!1,t.classEnded=!1,t.countdown="",t.statusMessage="",t.statusColor="medium",a<e?(t.countdown=_t(t.startDateTime),t.statusMessage="Join available at ".concat(Dt(e)),t.statusColor="medium"):a>=e&&a<t.startDateTime?(t.canJoin=!0,t.statusMessage="Class starting soon - Join now",t.statusColor="success"):kt(t.startDateTime,t.endDateTime)?(t.canJoin=!0,t.classInProgress=!0,t.statusMessage="Class in progress",t.statusColor="warning"):Tt(t.endDateTime)&&(t.classEnded=!0,t.statusMessage="Class has ended",t.statusColor="danger")}},Jt=function(){vt&&clearInterval(vt),vt=window.setInterval(function(){gt.value.forEach(function(t){if(t.isToday&&t.startDateTime&&t.endDateTime){var a=new Date,e=new Date(t.startDateTime.getTime()-6e5);t.canJoin=!1,t.statusMessage="",t.statusColor="medium",a<e?(t.countdown=_t(t.startDateTime),t.statusMessage="Join available at ".concat(Dt(e))):a>=e&&a<t.startDateTime?(t.canJoin=!0,t.countdown="",t.statusMessage="Join now to enter class",t.statusColor="success"):kt(t.startDateTime,t.endDateTime)?(t.canJoin=!0,t.countdown="",t.statusMessage="Class in progress - Join now",t.statusColor="warning"):Tt(t.endDateTime)&&(t.countdown="",t.statusMessage="Class has ended",t.statusColor="danger")}})},6e4)},Et=function(){var t=o(a().m(function t(e){var n;return a().w(function(t){for(;;)switch(t.n){case 0:if(e.canJoin&&e.meetingLink){t.n=1;break}return e.meetingLink||Q.show({text:"Meeting link not available for this class",position:"top",duration:"short"}),t.a(2);case 1:try{Q.show({text:"Opening ".concat(ut.value," class..."),position:"top",duration:"short"}),e.meetingLink.includes("zoom.us")?(n=e.meetingLink.replace("/j/","/join/"),window.open(n,"_system")):e.meetingLink.includes("meet.google.com")?window.open(e.meetingLink,"_system"):window.open(e.meetingLink,"_blank")}catch(a){console.error("Error joining class:",a),Q.show({text:"Failed to open meeting link",position:"top",duration:"short"})}case 2:return t.a(2)}},t)}));return function(a){return t.apply(this,arguments)}}(),It=function(){return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(n)}},Mt=function(t){if(console.error("Error fetching data:",t),v.isAxiosError(t)){var a;if(401===(null===(a=t.response)||void 0===a?void 0:a.status))return ct.replace("/"),void Q.show({text:"Session expired. Please login again",position:"top",duration:"long"});if("ECONNABORTED"===t.code)return void Q.show({text:"Request timeout. Please try again",position:"top"})}Q.show({text:"Failed to load data. Please try again later",position:"top"})},Pt=function(t){var a=t.matches;b(a)},Lt=function(){var t=window.matchMedia("(prefers-color-scheme: dark)");return Pt(t),t.addEventListener("change",Pt),t};return l(function(){Lt(),dt.value=function(){var t=new Date,a=t.getDay()||7,e=new Date(t);e.setDate(t.getDate()-a+1);var n=new Date(e);n.setDate(e.getDate()+6);var o={month:"short",day:"numeric"};return"".concat(e.toLocaleDateString(void 0,o)," - ").concat(n.toLocaleDateString(void 0,o))}(),jt()}),u(o(a().m(function t(){return a().w(function(t){for(;;)switch(t.n){case 0:Lt();case 1:return t.a(2)}},t)}))),d(function(){vt&&(clearInterval(vt),vt=null)}),function(a,e){return N(),m(p(g),null,{default:f(function(){return[h(p(D),null,{default:f(function(){return[h(p(x),null,{default:f(function(){return[h(p(w),{slot:"start"},{default:f(function(){return[h(p(k),{"default-href":"/"})]}),_:1}),h(p(T),null,{default:f(function(){return t(e[0]||(e[0]=[_("Classroom",-1)]))}),_:1})]}),_:1})]}),_:1}),h(p(A),{class:"ion-padding",fullscreen:!0},{default:f(function(){return[j("div",X,[ut.value?(N(),m(p(J),{key:0,class:"title"},{default:f(function(){return[_(E(ut.value),1)]}),_:1})):C("",!0),h(p(J),{class:"subtitle"},{default:f(function(){return[_(E(dt.value),1)]}),_:1})]),mt.value?(N(),S("div",Z,[h(p(I),{name:"crescent",color:"primary"})])):pt.value?ft.value?(N(),S("div",at,[h(p(M),{icon:p(L),color:"danger",size:"large"},null,8,["icon"]),h(p(J),null,{default:f(function(){return t(e[2]||(e[2]=[j("h3",null,"Failed to load timetable",-1),j("p",null,"Please try again later",-1)]))}),_:1}),h(p(O),{onClick:jt,fill:"clear"},{default:f(function(){return t(e[3]||(e[3]=[_("Retry",-1)]))}),_:1})])):(N(),S("div",et,[(N(!0),S(z,null,K(gt.value,function(a,n){return N(),m(p(F),{key:n,class:G(["day-card",{"today-card":a.isToday}])},{default:f(function(){return[h(p(R),null,{default:f(function(){return[h(p(B),{class:"day-title"},{default:f(function(){return[_(E(a.name)+" ",1),a.isToday?(N(),m(p(Y),{key:0,color:"success"},{default:f(function(){return t(e[4]||(e[4]=[_("Today",-1)]))}),_:1})):C("",!0)]}),_:2},1024)]}),_:2},1024),h(p($),{class:"time-content"},{default:f(function(){return[h(p(q),{lines:"none"},{default:f(function(){return[h(p(M),{slot:"start",icon:p(H),color:"primary"},null,8,["icon"]),h(p(U),null,{default:f(function(){return[_(E(a.startTime)+" - "+E(a.endTime),1)]}),_:2},1024)]}),_:2},1024),a.isToday?(N(),S("div",nt,[h(p(O),{class:"join-button",disabled:!a.canJoin||!a.meetingLink,fill:ht(a),color:bt(a),onClick:function(t){return Et(a)},expand:"block"},{default:f(function(){return[h(p(M),{slot:"start",icon:xt(a)},null,8,["icon"]),_(" "+E(yt(a)),1)]}),_:2},1032,["disabled","fill","color","onClick"]),!a.meetingLink&&a.canJoin?(N(),S("div",ot,[h(p(J),{color:"danger"},{default:f(function(){return t(e[5]||(e[5]=[j("small",null,"Meeting link not available",-1)]))}),_:1})])):C("",!0),!a.countdown||a.canJoin||a.classInProgress?C("",!0):(N(),S("div",rt,[h(p(J),{color:"medium"},{default:f(function(){return[_(" Starts in "+E(a.countdown),1)]}),_:2},1024)])),a.statusMessage?(N(),S("div",it,[h(p(J),{color:a.statusColor},{default:f(function(){return[_(E(a.statusMessage),1)]}),_:2},1032,["color"])])):C("",!0)])):(N(),S("div",st,[h(p(J),{color:"medium"},{default:f(function(){return[_(" Join link will be available on "+E(a.name),1)]}),_:2},1024)]))]}),_:2},1024)]}),_:2},1032,["class"])}),128))])):(N(),S("div",tt,[h(p(M),{icon:p(P),size:"large"},null,8,["icon"]),h(p(J),null,{default:f(function(){return t(e[1]||(e[1]=[j("h3",null,"No Classes Scheduled",-1),j("p",null,"Your timetable will appear here when classes are scheduled",-1)]))}),_:1})]))]}),_:1})]}),_:1})}}});e("default",W(ct,[["__scopeId","data-v-72730a9a"]]))}}})}();
