import{d as ee,aq as te,r as g,c as se,i as F,o as ae,P as ne,a as w,w as n,u as e,I as oe,b as $,e as le,f as ie,g as t,h as re,j as ue,as as ce,m as de,B as l,s as me,l as i,v as p,aa as S,a3 as r,t as m,y as M,D as L,p as u,H as fe,aI as ge,x as pe,aB as _e,n as T,a2 as he,a4 as ve,R as ye,S as we,N as ke,O as c,ax as Ie,a7 as Ce,Z as De,a9 as Oe,at as Se,K as Te,aH as be,aJ as xe,aC as Be,aD as R,ak as Ae,aK as Ne,aL as Pe,aM as Ee,aN as Fe,aO as V,_ as $e}from"./index-D8EdY7VT.js";import{T as _}from"./index-DSbRV_FN.js";const Me={class:"header-section ion-padding"},Le={class:"summary-cards"},Re={class:"summary-content"},Ve={class:"summary-content"},He={key:0,class:"loading-container"},je={key:1,class:"empty-state"},ze={key:2,class:"error-state"},Ue={key:3},qe={class:"assignment-header"},Je={class:"assignment-meta theme-text-eight"},Ke={key:0,class:"assignment-notes"},Ze={class:"assignment-footer"},We=ee({__name:"AssignmentPage",setup(Ye){const H=localStorage.getItem("parisklegg_token")||"",b=localStorage.getItem("parisklegg_user"),k=b?JSON.parse(b):null;k!=null&&k.user_id;const j=te(),z=le(),U=Number(j.params.id),I=g(""),C=g(!0),h=g(!1),x=g(!1),v=g([]),D=g(0),O=g(0),y=a=>{const s=new Date,o=new Date(a.submission_date),f=o.getTime()-s.getTime(),d=Math.ceil(f/(1e3*60*60*24));return s>o?"closed":d<=1?"dueSoon":d<=3?"upcoming":"open"},B=se(()=>F("ios")||F("android")),q=a=>{switch(y(a)){case"closed":return"var(--ion-color-warning)";case"dueSoon":return"var(--ion-color-warning)";case"upcoming":return"var(--ion-color-primary)";default:return"var(--ion-color-success)"}},J=a=>{switch(y(a)){case"closed":return"warning";case"open":return"success";case"dueSoon":return"warning";case"upcoming":return"primary";default:return"success"}},K=a=>{switch(y(a)){case"closed":return V;case"open":return V;case"dueSoon":return Fe;case"upcoming":return Ee;default:return Pe}},Z=a=>{const s=new Date,o=new Date(a.submission_date),f=o.getTime()-s.getTime(),d=Math.ceil(f/(1e3*60*60*24));return s>o?"Closed":d<=1?"Due Soon":d<=3?"Due in ".concat(d," days"):"Open"},A=a=>{const s=new Date(a),o=new Date(s);return new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"}).format(o)},N=async()=>{try{C.value=!0,h.value=!1,v.value=[],D.value=0,O.value=0;const a=await $.post("https://klegg-app-whh7m.ondigitalocean.app/api/assignment",{tutorship_id:U},{headers:Q(),timeout:2e4});a.data.length>0&&(x.value=!0,I.value=a.data[0].tutorship_name||"My Assignments",v.value=a.data.sort((s,o)=>new Date(s.submission_date).getTime()-new Date(o.submission_date).getTime()),v.value.forEach(s=>{y(s)==="closed"?D.value++:O.value++}))}catch(a){X(a),h.value=!0}finally{C.value=!1}},W=async(a,s="view")=>{try{const o=await _.show({text:s==="view"?"Opening file...":"Opening file for download...",position:"top"}),f="https://storage.draugustinaosabutey.com/api/files/".concat(a,"/view");window.open(f,"_blank"),await _.show({text:"File opened successfully",position:"top",duration:"short"})}catch(o){console.error("File access error:",o),await _.show({text:"Failed to open file. Please try again.",position:"top",duration:"long"})}},Y=a=>{console.log("Sharing assignment:",a)},G=a=>{console.log("Viewing submission for:",a)},Q=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(H)}),X=a=>{var s;if(console.error("Error fetching data:",a),$.isAxiosError(a)){if(((s=a.response)==null?void 0:s.status)===401){z.replace("/"),_.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(a.code==="ECONNABORTED"){_.show({text:"Request timeout. Please try again",position:"top"});return}}_.show({text:"Failed to load data. Please try again later",position:"top"})},P=a=>{const s=a.matches;ie(s)},E=()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return P(a),a.addEventListener("change",P),a};return ae(()=>{E(),N()}),ne(async()=>{E()}),(a,s)=>(c(),w(e(oe),null,{default:n(()=>[t(e(me),null,{default:n(()=>[t(e(re),null,{default:n(()=>[t(e(ue),{slot:"start"},{default:n(()=>[t(e(ce),{"default-href":"/"})]),_:1}),t(e(de),null,{default:n(()=>[...s[1]||(s[1]=[l("Assignments",-1)])]),_:1})]),_:1})]),_:1}),t(e(ke),{fullscreen:!0},{default:n(()=>[i("div",Me,[I.value?(c(),w(e(r),{key:0,class:"title"},{default:n(()=>[l(m(I.value),1)]),_:1})):S("",!0),i("div",Le,[t(e(M),{class:"summary-card open"},{default:n(()=>[t(e(L),null,{default:n(()=>[i("div",Re,[t(e(u),{icon:e(fe),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:n(()=>[l(m(O.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:n(()=>[...s[2]||(s[2]=[l("Open",-1)])]),_:1})])])]),_:1})]),_:1}),t(e(M),{class:"summary-card closed"},{default:n(()=>[t(e(L),null,{default:n(()=>[i("div",Ve,[t(e(u),{icon:e(ge),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:n(()=>[l(m(D.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:n(()=>[...s[3]||(s[3]=[l("Closed",-1)])]),_:1})])])]),_:1})]),_:1})])]),C.value?(c(),p("div",He,[t(e(pe),{name:"crescent",color:"primary"})])):!x.value&&!h.value?(c(),p("div",je,[t(e(u),{icon:e(_e),color:"medium"},null,8,["icon"]),t(e(r),null,{default:n(()=>[...s[4]||(s[4]=[i("h3",null,"No Assignments",-1),i("p",null,"Your assignments will appear here when created by your teacher",-1)])]),_:1}),t(e(T),{fill:"clear",onClick:s[0]||(s[0]=o=>a.$router.back())},{default:n(()=>[...s[5]||(s[5]=[l("Back to Classes",-1)])]),_:1})])):h.value?(c(),p("div",ze,[t(e(u),{icon:e(he),color:"warning"},null,8,["icon"]),t(e(r),null,{default:n(()=>[...s[6]||(s[6]=[i("h3",null,"Error Loading Assignments",-1),i("p",null,"Please try again later",-1)])]),_:1}),t(e(T),{fill:"clear",onClick:N},{default:n(()=>[...s[7]||(s[7]=[l("Retry",-1)])]),_:1})])):(c(),p("div",Ue,[t(e(ve),{lines:"none"},{default:n(()=>[(c(!0),p(ye,null,we(v.value,(o,f)=>(c(),w(e(Ie),{key:f},{default:n(()=>[t(e(Ce),{class:"assignment-item",detail:!1},{default:n(()=>[i("div",{slot:"start",class:"status-indicator",style:De({backgroundColor:q(o)})},null,4),t(e(Oe),{class:"assignment-content"},{default:n(()=>[i("div",qe,[t(e(r),{class:"assignment-title"},{default:n(()=>[l(m(o.assignment_name),1)]),_:2},1024),t(e(Se),{color:J(o)},{default:n(()=>[t(e(u),{icon:K(o),slot:"start"},null,8,["icon"]),l(" "+m(Z(o)),1)]),_:2},1032,["color"])]),i("div",Je,[t(e(r),{class:"assignment-date"},{default:n(()=>[t(e(u),{icon:e(Te)},null,8,["icon"]),l(" Posted: "+m(A(o.created_at)),1)]),_:2},1024)]),o.additional_note?(c(),p("div",Ke,[t(e(r),{class:"theme-text-nine"},{default:n(()=>[l(m(o.additional_note),1)]),_:2},1024)])):S("",!0),i("div",Ze,[t(e(r),{class:"due-date"},{default:n(()=>[t(e(u),{icon:e(be)},null,8,["icon"]),l(" Due: "+m(A(o.submission_date)),1)]),_:2},1024),o.assignment_file?(c(),w(e(T),{key:0,fill:"clear",size:"small",onClick:d=>W(o.assignment_file,B.value?"view":"download")},{default:n(()=>[t(e(u),{slot:"start",icon:e(xe)},null,8,["icon"]),l(" "+m(B.value?"Open":"Download"),1)]),_:1},8,["onClick"])):S("",!0)])]),_:2},1024)]),_:2},1024),t(e(Be),{side:"end"},{default:n(()=>[t(e(R),{color:"tertiary",onClick:d=>Y(o)},{default:n(()=>[t(e(u),{slot:"icon-only",icon:e(Ae)},null,8,["icon"])]),_:1},8,["onClick"]),t(e(R),{color:"primary",onClick:d=>G(o)},{default:n(()=>[t(e(u),{slot:"icon-only",icon:e(Ne)},null,8,["icon"])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1})]),_:1}))}}),Xe=$e(We,[["__scopeId","data-v-3b3007d8"]]);export{Xe as default};
