import{d as Z,ao as Q,r as f,S as D,a as X,o as ee,b as h,w as a,u as e,I as te,e as E,f as se,g as t,h as ae,i as ne,P as oe,l as le,A as l,q as ie,k as i,s as g,a9 as O,a3 as r,t as m,x as P,C as $,n as u,G as re,aD as ue,v as ce,aw as de,m as b,a2 as me,a4 as fe,T as _e,U as ge,M as pe,N as c,as as ye,a7 as ve,$ as he,K as we,ap as ke,J as Ie,aC as Ce,aE as Se,ax as De,ay as F,aj as Oe,aF as be,aG as Te,aH as xe,aI as Ae,aJ as V,_ as Be}from"./index-6dl2zJ1O.js";import{T}from"./index-fbeSVdeg.js";const Ne={class:"header-section ion-padding"},Ee={class:"summary-cards"},Pe={class:"summary-content"},$e={class:"summary-content"},Fe={key:0,class:"loading-container"},Ve={key:1,class:"empty-state"},Le={key:2,class:"error-state"},Me={key:3},Re={class:"assignment-header"},je={class:"assignment-meta"},ze={key:0,class:"assignment-notes"},He={class:"assignment-footer"},Je=Z({__name:"AssignmentPage",setup(Ue){const L=localStorage.getItem("parisklegg_token")||"",x=localStorage.getItem("parisklegg_user"),w=x?JSON.parse(x):null;w!=null&&w.user_id;const M=Q(),R=se(),j=Number(M.params.id),k=f(""),I=f(!0),p=f(!1),A=f(!1),y=f([]),C=f(0),S=f(0),v=n=>{const s=new Date,o=new Date(n.submission_date),_=o.getTime()-s.getTime(),d=Math.ceil(_/(1e3*60*60*24));return s>o?"closed":d<=1?"dueSoon":d<=3?"upcoming":"open"},z=n=>{switch(v(n)){case"closed":return"var(--ion-color-warning)";case"dueSoon":return"var(--ion-color-warning)";case"upcoming":return"var(--ion-color-primary)";default:return"var(--ion-color-success)"}},H=n=>{switch(v(n)){case"closed":return"warning";case"open":return"success";case"dueSoon":return"warning";case"upcoming":return"primary";default:return"success"}},J=n=>{switch(v(n)){case"closed":return V;case"open":return V;case"dueSoon":return Ae;case"upcoming":return xe;default:return Te}},U=n=>{const s=new Date,o=new Date(n.submission_date),_=o.getTime()-s.getTime(),d=Math.ceil(_/(1e3*60*60*24));return s>o?"Closed":d<=1?"Due Soon":d<=3?"Due in ".concat(d," days"):"Open"},B=n=>{const s=new Date(n),o=new Date(s);return new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"}).format(o)},N=async()=>{try{I.value=!0,p.value=!1,y.value=[],C.value=0,S.value=0;const n=await E.post("https://school.klgilc.com/api/assignment",{tutorship_id:j},{headers:W(),timeout:2e4});n.data.length>0&&(A.value=!0,k.value=n.data[0].tutorship_name||"My Assignments",y.value=n.data.sort((s,o)=>new Date(s.submission_date).getTime()-new Date(o.submission_date).getTime()),y.value.forEach(s=>{v(s)==="closed"?C.value++:S.value++}))}catch(n){Y(n),p.value=!0}finally{I.value=!1}},q=n=>{window.open("https://school.klgilc.com/files/".concat(n),"_blank")},G=n=>{console.log("Sharing assignment:",n)},K=n=>{console.log("Viewing submission for:",n)},W=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(L)}),Y=n=>{var s;if(console.error("Error fetching data:",n),E.isAxiosError(n)){if(((s=n.response)==null?void 0:s.status)===401){R.replace("/"),T.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(n.code==="ECONNABORTED"){T.show({text:"Request timeout. Please try again",position:"top"});return}}T.show({text:"Failed to load data. Please try again later",position:"top"})};return D.setOverlaysWebView({overlay:!1}),D.setBackgroundColor({color:"#ffffff"}),D.setStyle({style:X.Light}),ee(()=>{N()}),(n,s)=>(c(),h(e(te),null,{default:a(()=>[t(e(ie),null,{default:a(()=>[t(e(ae),null,{default:a(()=>[t(e(ne),{slot:"start"},{default:a(()=>[t(e(oe),{"default-href":"/"})]),_:1}),t(e(le),null,{default:a(()=>s[1]||(s[1]=[l("Assignments",-1)])),_:1,__:[1]})]),_:1})]),_:1}),t(e(pe),{fullscreen:!0},{default:a(()=>[i("div",Ne,[k.value?(c(),h(e(r),{key:0,class:"title"},{default:a(()=>[l(m(k.value),1)]),_:1})):O("",!0),i("div",Ee,[t(e(P),{class:"summary-card open"},{default:a(()=>[t(e($),null,{default:a(()=>[i("div",Pe,[t(e(u),{icon:e(re),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:a(()=>[l(m(S.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:a(()=>s[2]||(s[2]=[l("Open",-1)])),_:1,__:[2]})])])]),_:1})]),_:1}),t(e(P),{class:"summary-card closed"},{default:a(()=>[t(e($),null,{default:a(()=>[i("div",$e,[t(e(u),{icon:e(ue),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:a(()=>[l(m(C.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:a(()=>s[3]||(s[3]=[l("Closed",-1)])),_:1,__:[3]})])])]),_:1})]),_:1})])]),I.value?(c(),g("div",Fe,[t(e(ce),{name:"crescent",color:"primary"})])):!A.value&&!p.value?(c(),g("div",Ve,[t(e(u),{icon:e(de),color:"medium"},null,8,["icon"]),t(e(r),null,{default:a(()=>s[4]||(s[4]=[i("h3",null,"No Assignments",-1),i("p",null,"Your assignments will appear here when created by your teacher",-1)])),_:1,__:[4]}),t(e(b),{fill:"clear",onClick:s[0]||(s[0]=o=>n.$router.back())},{default:a(()=>s[5]||(s[5]=[l("Back to Classes",-1)])),_:1,__:[5]})])):p.value?(c(),g("div",Le,[t(e(u),{icon:e(me),color:"warning"},null,8,["icon"]),t(e(r),null,{default:a(()=>s[6]||(s[6]=[i("h3",null,"Error Loading Assignments",-1),i("p",null,"Please try again later",-1)])),_:1,__:[6]}),t(e(b),{fill:"clear",onClick:N},{default:a(()=>s[7]||(s[7]=[l("Retry",-1)])),_:1,__:[7]})])):(c(),g("div",Me,[t(e(fe),{lines:"none"},{default:a(()=>[(c(!0),g(_e,null,ge(y.value,(o,_)=>(c(),h(e(ye),{key:_},{default:a(()=>[t(e(ve),{class:"assignment-item",detail:!1},{default:a(()=>[i("div",{slot:"start",class:"status-indicator",style:he({backgroundColor:z(o)})},null,4),t(e(we),{class:"assignment-content"},{default:a(()=>[i("div",Re,[t(e(r),{class:"assignment-title"},{default:a(()=>[l(m(o.assignment_name),1)]),_:2},1024),t(e(ke),{color:H(o)},{default:a(()=>[t(e(u),{icon:J(o),slot:"start"},null,8,["icon"]),l(" "+m(U(o)),1)]),_:2},1032,["color"])]),i("div",je,[t(e(r),{class:"assignment-date"},{default:a(()=>[t(e(u),{icon:e(Ie)},null,8,["icon"]),l(" Posted: "+m(B(o.created_at)),1)]),_:2},1024)]),o.additional_note?(c(),g("div",ze,[t(e(r),null,{default:a(()=>[l(m(o.additional_note),1)]),_:2},1024)])):O("",!0),i("div",He,[t(e(r),{class:"due-date"},{default:a(()=>[t(e(u),{icon:e(Ce)},null,8,["icon"]),l(" Due: "+m(B(o.submission_date)),1)]),_:2},1024),o.assignment_file?(c(),h(e(b),{key:0,fill:"clear",size:"small",onClick:d=>q(o.assignment_file)},{default:a(()=>[t(e(u),{slot:"start",icon:e(Se)},null,8,["icon"]),s[8]||(s[8]=l(" Download ",-1))]),_:2,__:[8]},1032,["onClick"])):O("",!0)])]),_:2},1024)]),_:2},1024),t(e(De),{side:"end"},{default:a(()=>[t(e(F),{color:"tertiary",onClick:d=>G(o)},{default:a(()=>[t(e(u),{slot:"icon-only",icon:e(Oe)},null,8,["icon"])]),_:2},1032,["onClick"]),t(e(F),{color:"primary",onClick:d=>K(o)},{default:a(()=>[t(e(u),{slot:"icon-only",icon:e(be)},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1})]),_:1}))}}),Ke=Be(Je,[["__scopeId","data-v-4bbef26e"]]);export{Ke as default};
