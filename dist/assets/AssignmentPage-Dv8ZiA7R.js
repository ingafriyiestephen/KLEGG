import{d as Q,ao as X,r as f,o as ee,O as te,a as v,w as n,u as e,I as se,b as P,e as ae,f as ne,g as t,h as oe,i as le,P as ie,l as re,A as l,q as ue,k as i,s as p,a9 as S,a3 as r,t as m,x as $,C as F,n as u,G as ce,aF as de,v as me,ay as fe,m as O,a2 as ge,a4 as pe,S as _e,T as he,M as ye,N as c,au as ve,a7 as we,$ as ke,K as Ie,aq as Ce,J as De,aE as Se,aG as Oe,az as Te,aA as L,aj as be,aH as xe,aI as Ae,aJ as Be,aK as Ee,aL as M,_ as Ne}from"./index-CbFFUppU.js";import{T}from"./index-HY87JrIe.js";const Pe={class:"header-section ion-padding"},$e={class:"summary-cards"},Fe={class:"summary-content"},Le={class:"summary-content"},Me={key:0,class:"loading-container"},Ve={key:1,class:"empty-state"},Re={key:2,class:"error-state"},ze={key:3},je={class:"assignment-header"},qe={class:"assignment-meta theme-text-eight"},He={key:0,class:"assignment-notes"},Je={class:"assignment-footer"},Ge=Q({__name:"AssignmentPage",setup(Ke){const V=localStorage.getItem("parisklegg_token")||"",b=localStorage.getItem("parisklegg_user"),w=b?JSON.parse(b):null;w!=null&&w.user_id;const R=X(),z=ae(),j=Number(R.params.id),k=f(""),I=f(!0),_=f(!1),x=f(!1),h=f([]),C=f(0),D=f(0),y=a=>{const s=new Date,o=new Date(a.submission_date),g=o.getTime()-s.getTime(),d=Math.ceil(g/(1e3*60*60*24));return s>o?"closed":d<=1?"dueSoon":d<=3?"upcoming":"open"},q=a=>{switch(y(a)){case"closed":return"var(--ion-color-warning)";case"dueSoon":return"var(--ion-color-warning)";case"upcoming":return"var(--ion-color-primary)";default:return"var(--ion-color-success)"}},H=a=>{switch(y(a)){case"closed":return"warning";case"open":return"success";case"dueSoon":return"warning";case"upcoming":return"primary";default:return"success"}},J=a=>{switch(y(a)){case"closed":return M;case"open":return M;case"dueSoon":return Ee;case"upcoming":return Be;default:return Ae}},G=a=>{const s=new Date,o=new Date(a.submission_date),g=o.getTime()-s.getTime(),d=Math.ceil(g/(1e3*60*60*24));return s>o?"Closed":d<=1?"Due Soon":d<=3?"Due in ".concat(d," days"):"Open"},A=a=>{const s=new Date(a),o=new Date(s);return new Intl.DateTimeFormat("en-US",{weekday:"short",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"UTC"}).format(o)},B=async()=>{try{I.value=!0,_.value=!1,h.value=[],C.value=0,D.value=0;const a=await P.post("https://klegg-app-whh7m.ondigitalocean.app/api/assignment",{tutorship_id:j},{headers:Y(),timeout:2e4});a.data.length>0&&(x.value=!0,k.value=a.data[0].tutorship_name||"My Assignments",h.value=a.data.sort((s,o)=>new Date(s.submission_date).getTime()-new Date(o.submission_date).getTime()),h.value.forEach(s=>{y(s)==="closed"?C.value++:D.value++}))}catch(a){Z(a),_.value=!0}finally{I.value=!1}},K=a=>{window.open("https://klegg-app-whh7m.ondigitalocean.app/files/".concat(a),"_blank")},U=a=>{console.log("Sharing assignment:",a)},W=a=>{console.log("Viewing submission for:",a)},Y=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(V)}),Z=a=>{var s;if(console.error("Error fetching data:",a),P.isAxiosError(a)){if(((s=a.response)==null?void 0:s.status)===401){z.replace("/"),T.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(a.code==="ECONNABORTED"){T.show({text:"Request timeout. Please try again",position:"top"});return}}T.show({text:"Failed to load data. Please try again later",position:"top"})},E=a=>{const s=a.matches;ne(s)},N=()=>{const a=window.matchMedia("(prefers-color-scheme: dark)");return E(a),a.addEventListener("change",E),a};return ee(()=>{N(),B()}),te(async()=>{N()}),(a,s)=>(c(),v(e(se),null,{default:n(()=>[t(e(ue),null,{default:n(()=>[t(e(oe),null,{default:n(()=>[t(e(le),{slot:"start"},{default:n(()=>[t(e(ie),{"default-href":"/"})]),_:1}),t(e(re),null,{default:n(()=>[...s[1]||(s[1]=[l("Assignments",-1)])]),_:1})]),_:1})]),_:1}),t(e(ye),{fullscreen:!0},{default:n(()=>[i("div",Pe,[k.value?(c(),v(e(r),{key:0,class:"title"},{default:n(()=>[l(m(k.value),1)]),_:1})):S("",!0),i("div",$e,[t(e($),{class:"summary-card open"},{default:n(()=>[t(e(F),null,{default:n(()=>[i("div",Fe,[t(e(u),{icon:e(ce),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:n(()=>[l(m(D.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:n(()=>[...s[2]||(s[2]=[l("Open",-1)])]),_:1})])])]),_:1})]),_:1}),t(e($),{class:"summary-card closed"},{default:n(()=>[t(e(F),null,{default:n(()=>[i("div",Le,[t(e(u),{icon:e(de),class:"summary-icon"},null,8,["icon"]),i("div",null,[t(e(r),{class:"summary-count"},{default:n(()=>[l(m(C.value),1)]),_:1}),t(e(r),{class:"summary-label"},{default:n(()=>[...s[3]||(s[3]=[l("Closed",-1)])]),_:1})])])]),_:1})]),_:1})])]),I.value?(c(),p("div",Me,[t(e(me),{name:"crescent",color:"primary"})])):!x.value&&!_.value?(c(),p("div",Ve,[t(e(u),{icon:e(fe),color:"medium"},null,8,["icon"]),t(e(r),null,{default:n(()=>[...s[4]||(s[4]=[i("h3",null,"No Assignments",-1),i("p",null,"Your assignments will appear here when created by your teacher",-1)])]),_:1}),t(e(O),{fill:"clear",onClick:s[0]||(s[0]=o=>a.$router.back())},{default:n(()=>[...s[5]||(s[5]=[l("Back to Classes",-1)])]),_:1})])):_.value?(c(),p("div",Re,[t(e(u),{icon:e(ge),color:"warning"},null,8,["icon"]),t(e(r),null,{default:n(()=>[...s[6]||(s[6]=[i("h3",null,"Error Loading Assignments",-1),i("p",null,"Please try again later",-1)])]),_:1}),t(e(O),{fill:"clear",onClick:B},{default:n(()=>[...s[7]||(s[7]=[l("Retry",-1)])]),_:1})])):(c(),p("div",ze,[t(e(pe),{lines:"none"},{default:n(()=>[(c(!0),p(_e,null,he(h.value,(o,g)=>(c(),v(e(ve),{key:g},{default:n(()=>[t(e(we),{class:"assignment-item",detail:!1},{default:n(()=>[i("div",{slot:"start",class:"status-indicator",style:ke({backgroundColor:q(o)})},null,4),t(e(Ie),{class:"assignment-content"},{default:n(()=>[i("div",je,[t(e(r),{class:"assignment-title"},{default:n(()=>[l(m(o.assignment_name),1)]),_:2},1024),t(e(Ce),{color:H(o)},{default:n(()=>[t(e(u),{icon:J(o),slot:"start"},null,8,["icon"]),l(" "+m(G(o)),1)]),_:2},1032,["color"])]),i("div",qe,[t(e(r),{class:"assignment-date"},{default:n(()=>[t(e(u),{icon:e(De)},null,8,["icon"]),l(" Posted: "+m(A(o.created_at)),1)]),_:2},1024)]),o.additional_note?(c(),p("div",He,[t(e(r),{class:"theme-text-nine"},{default:n(()=>[l(m(o.additional_note),1)]),_:2},1024)])):S("",!0),i("div",Je,[t(e(r),{class:"due-date"},{default:n(()=>[t(e(u),{icon:e(Se)},null,8,["icon"]),l(" Due: "+m(A(o.submission_date)),1)]),_:2},1024),o.assignment_file?(c(),v(e(O),{key:0,fill:"clear",size:"small",onClick:d=>K(o.assignment_file)},{default:n(()=>[t(e(u),{slot:"start",icon:e(Oe)},null,8,["icon"]),s[8]||(s[8]=l(" Download ",-1))]),_:1},8,["onClick"])):S("",!0)])]),_:2},1024)]),_:2},1024),t(e(Te),{side:"end"},{default:n(()=>[t(e(L),{color:"tertiary",onClick:d=>U(o)},{default:n(()=>[t(e(u),{slot:"icon-only",icon:e(be)},null,8,["icon"])]),_:1},8,["onClick"]),t(e(L),{color:"primary",onClick:d=>W(o)},{default:n(()=>[t(e(u),{slot:"icon-only",icon:e(xe)},null,8,["icon"])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]))]),_:1})]),_:1}))}}),Ye=Ne(Ge,[["__scopeId","data-v-7024739f"]]);export{Ye as default};
