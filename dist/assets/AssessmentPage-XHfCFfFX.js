import{d as q,ao as F,r as y,c as I,o as j,O as W,a as k,w as n,u as e,I as J,b as O,e as K,f as U,g as a,h as Y,i as Q,P as X,l as Z,A as r,q as ee,s as g,x as te,y as ae,z as se,n as m,aM as ne,C as oe,k as l,a3 as i,t as d,W as re,v as le,ay as ie,a2 as ue,m as de,a4 as ce,T as me,S as fe,M as ge,N as c,au as pe,a7 as _e,aN as ve,K as he,aq as ye,az as Ie,aA as ke,ak as Ce,_ as Se}from"./index-CbFFUppU.js";import{T as C}from"./index-HY87JrIe.js";const we={class:"summary-item"},Ae={class:"summary-item"},xe={key:0,class:"loading-container"},Be={key:1,class:"empty-state"},Te={key:2,class:"error-state"},Oe={class:"assessment-header"},Pe={class:"assessment-meta"},Ee=q({__name:"AssessmentPage",setup(Ne){const P=localStorage.getItem("parisklegg_token")||"",S=localStorage.getItem("parisklegg_user"),p=S?JSON.parse(S):null,E=(p==null?void 0:p.user_id)||0,N=F(),D=K(),b=Number(N.params.id),_=y(!0),f=y(!1),u=y([]),M=I(()=>u.value.length>0),z=I(()=>u.value.length),w=I(()=>{if(u.value.length===0)return 0;const t=u.value.reduce((s,o)=>s+v(o),0);return Math.round(t/u.value.length)}),v=t=>t.score_denominator===0?0:Math.round(t.score_numerator/t.score_denominator*100),L=t=>t>=85?"excellent":t>=70?"good":t>=50?"average":"poor",G=t=>t>=85?"success":t>=70?"primary":t>=50?"warning":"danger",R=t=>{const s=new Date(t),o=s.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),h=s.getHours().toString().padStart(2,"0"),T=s.getMinutes().toString().padStart(2,"0");return"".concat(o,", ").concat(h,":").concat(T)},A=async()=>{try{_.value=!0,f.value=!1,u.value=[];const t=await O.post("https://klegg-app-whh7m.ondigitalocean.app/api/marks",{tutorship_id:b,student_id:E},{headers:$(),timeout:2e4});u.value=t.data}catch(t){console.error("Error fetching assessments:",t),H(t),f.value=!0}finally{_.value=!1}},V=t=>{console.log("Viewing details for:",t)},$=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(P)}),H=t=>{var s;if(console.error("Error fetching data:",t),O.isAxiosError(t)){if(((s=t.response)==null?void 0:s.status)===401){D.replace("/"),C.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(t.code==="ECONNABORTED"){C.show({text:"Request timeout. Please try again",position:"top"});return}}C.show({text:"Failed to load data. Please try again later",position:"top"})},x=t=>{const s=t.matches;U(s)},B=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)");return x(t),t.addEventListener("change",x),t};return j(()=>{B(),A()}),W(async()=>{B()}),(t,s)=>(c(),k(e(J),null,{default:n(()=>[a(e(ee),null,{default:n(()=>[a(e(Y),null,{default:n(()=>[a(e(Q),{slot:"start"},{default:n(()=>[a(e(X),{"default-href":"/"})]),_:1}),a(e(Z),null,{default:n(()=>[...s[0]||(s[0]=[r("Assessment",-1)])]),_:1})]),_:1})]),_:1}),a(e(ge),{fullscreen:!0},{default:n(()=>[a(e(te),{class:"summary-card"},{default:n(()=>[a(e(ae),null,{default:n(()=>[a(e(se),{class:"summary-title"},{default:n(()=>[a(e(m),{icon:e(ne),color:"primary"},null,8,["icon"]),s[1]||(s[1]=r(" Overall Performance ",-1))]),_:1})]),_:1}),a(e(oe),{class:"summary-content"},{default:n(()=>[l("div",we,[a(e(i),{class:"summary-label"},{default:n(()=>[...s[2]||(s[2]=[r("Assignments Graded",-1)])]),_:1}),a(e(i),{class:"summary-value"},{default:n(()=>[r(d(z.value),1)]),_:1})]),s[4]||(s[4]=l("div",{class:"divider"},null,-1)),l("div",Ae,[a(e(i),{class:"summary-label"},{default:n(()=>[...s[3]||(s[3]=[r("Average Score",-1)])]),_:1}),a(e(i),{class:re(["summary-value",L(w.value)])},{default:n(()=>[r(d(w.value)+"% ",1)]),_:1},8,["class"])])]),_:1})]),_:1}),_.value?(c(),g("div",xe,[a(e(le),{name:"crescent",color:"primary"})])):!M.value&&!f.value?(c(),g("div",Be,[a(e(m),{icon:e(ie),size:"large",color:"medium"},null,8,["icon"]),a(e(i),null,{default:n(()=>[...s[5]||(s[5]=[l("h3",null,"No Grades Available",-1),l("p",null,"Your grades will appear here once they're posted",-1)])]),_:1})])):f.value?(c(),g("div",Te,[a(e(m),{icon:e(ue),size:"large",color:"danger"},null,8,["icon"]),a(e(i),null,{default:n(()=>[...s[6]||(s[6]=[l("h3",null,"Error Loading Grades",-1),l("p",null,"Please try again later",-1)])]),_:1}),a(e(de),{fill:"clear",onClick:A},{default:n(()=>[...s[7]||(s[7]=[r("Retry",-1)])]),_:1})])):(c(),k(e(ce),{key:3,lines:"none"},{default:n(()=>[(c(!0),g(fe,null,me(u.value,(o,h)=>(c(),k(e(pe),{key:h},{default:n(()=>[a(e(_e),{class:"assessment-item"},{default:n(()=>[a(e(m),{slot:"start",icon:e(ve),color:"primary"},null,8,["icon"]),a(e(he),{class:"assessment-content"},{default:n(()=>[l("div",Oe,[a(e(i),{class:"assessment-title"},{default:n(()=>[r(d(o.assignment_name||"Assignment"),1)]),_:2},1024),a(e(ye),{color:G(v(o))},{default:n(()=>[r(d(v(o))+"% ",1)]),_:2},1032,["color"])]),l("div",Pe,[a(e(i),{class:"assessment-score"},{default:n(()=>[r(d(o.score_numerator)+"/"+d(o.score_denominator),1)]),_:2},1024),a(e(i),{class:"assessment-date"},{default:n(()=>[r(d(R(o.created_at)),1)]),_:2},1024)])]),_:2},1024)]),_:2},1024),a(e(Ie),{side:"end"},{default:n(()=>[a(e(ke),{color:"tertiary",onClick:T=>V(o)},{default:n(()=>[a(e(m),{slot:"icon-only",icon:e(Ce)},null,8,["icon"])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1}))}}),Me=Se(Ee,[["__scopeId","data-v-b4da8244"]]);export{Me as default};
