import{d as H,r as y,P as Y,o as J,a as Q,w as i,u as o,I as U,b as B,e as X,f as Z,g as a,h as G,j as $,m as K,B as C,n as I,p as h,Q as ee,s as te,v as c,l as s,L as se,R as w,S as x,N as oe,O as r,t as d,T as N,U as ne,V as ae,W as le,X as ie,Y as re,Z as P,$ as ce,a0 as de,_ as ue}from"./index-D6yZBIDx.js";import{T}from"./index-D-N4iO5a.js";const pe={key:0,class:"loading-container"},_e={key:1,class:"creative-empty-state"},he={key:2,class:"class-grid"},ge=["onClick"],ve={class:"card-content"},be={class:"card-header"},ke={class:"subject-badge"},fe=["onClick"],me={class:"subject-name"},ye={class:"ribbon-row top-row"},Ce=["onClick"],we={class:"ribbon-row bottom-row"},xe=["onClick"],Ne=H({__name:"TutorshipPage",setup(Te){const R=localStorage.getItem("parisklegg_token")||"",j=localStorage.getItem("parisklegg_user"),g=j?JSON.parse(j):null,v=(g==null?void 0:g.user_id)||0;console.log(v);const b=X(),k=y(null),u=y(!0),f=y([]),m=async()=>{try{u.value=!0;const t=await B.get("https://klegg-app-whh7m.ondigitalocean.app/api/tutorships",{headers:L(),timeout:2e4});if(isNaN(v))throw new Error("Invalid student ID");f.value=t.data.filter(e=>{var p;try{return(((p=e.students_list)==null?void 0:p.split(",").map(Number).filter(_=>!isNaN(_)))||[]).includes(v)}catch(l){return console.warn("Error parsing students_list",e),!1}}).map(e=>({...e,rating_score:e.average_rating!==void 0?parseFloat(e.average_rating.toFixed(1)):void 0}))}catch(t){q(t)}finally{u.value=!1}},A=()=>{u.value=!0,m()},D=t=>({default:"ðŸ“–"}).default,E=[{id:1,icon:le,label:"Classroom",url:"classroom"},{id:2,icon:ie,label:"Attendance",url:"attendance"},{id:3,icon:re,label:"Assignment",url:"assignment"}],F=[{id:4,icon:ce,label:"Assessment",url:"assessment"},{id:5,icon:de,label:"Exam",url:"exam"}],M=t=>{k.value=k.value===t?null:t},V=(t,e)=>{b.push("/rate/".concat(t))},O=(t,e)=>{b.push("/".concat(e,"/").concat(t,"/"))},L=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(R)}),q=t=>{var e;if(console.error("Error fetching data:",t),B.isAxiosError(t)){if(((e=t.response)==null?void 0:e.status)===401){b.replace("/"),T.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(t.code==="ECONNABORTED"){T.show({text:"Request timeout. Please try again",position:"top"});return}}T.show({text:"Failed to load data. Please try again later",position:"top"})},S=t=>{const e=t.matches;Z(e)};Y(async()=>{await m()});const z=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)");return S(t),t.addEventListener("change",S),t};return J(()=>{z(),m()}),(t,e)=>{const p=se("ion-spinner");return r(),Q(o(U),{class:"modern-school-theme"},{default:i(()=>[a(o(te),null,{default:i(()=>[a(o(G),null,{default:i(()=>[a(o($),{slot:"start"}),a(o(K),{class:"page-title"},{default:i(()=>[...e[0]||(e[0]=[C("My Classes",-1)])]),_:1}),a(o($),{slot:"end"},{default:i(()=>[a(o(I),{onClick:A,fill:"clear",class:"refresh-btn"},{default:i(()=>[a(o(h),{icon:o(ee),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),a(o(oe),{fullscreen:!0,class:"content-bg"},{default:i(()=>[u.value?(r(),c("div",pe,[a(p,{name:"crescent",color:"primary"}),e[1]||(e[1]=s("p",null,"Loading your classes...",-1))])):f.value.length===0?(r(),c("div",_e,[e[3]||(e[3]=s("div",{class:"desk-illustration"},[s("div",{class:"desk"}),s("div",{class:"lamp"}),s("div",{class:"book-stack"},[s("div",{class:"book"}),s("div",{class:"book"}),s("div",{class:"book"})])],-1)),e[4]||(e[4]=s("h3",null,"No Classes Yet",-1)),e[5]||(e[5]=s("p",null,"When you enroll in a class, it'll appear here",-1)),a(o(I),{onClick:A,fill:"solid",class:"cta-button"},{default:i(()=>[...e[2]||(e[2]=[C(" Check Again ",-1)])]),_:1})])):(r(),c("div",he,[(r(!0),c(w,null,x(f.value,l=>{var _;return r(),c("div",{key:l.tutorship_id,class:"class-card",onClick:n=>M(l.tutorship_id)},[s("div",ve,[s("div",be,[s("div",ke,d(D(l.subject_name)),1),s("div",{class:"quick-action",onClick:N(n=>V(l.tutorship_id,"rate"),["stop"])},[a(o(h),{icon:o(ne)},null,8,["icon"]),C(" "+d(((_=l.average_rating)==null?void 0:_.toFixed(1))||"Rate"),1)],8,fe)]),s("h3",null,d(l.tutorship_name),1),s("p",me,d(l.subject_name),1)]),s("div",{class:ae(["action-ribbon two-row",{active:k.value===l.tutorship_id}])},[s("div",ye,[(r(),c(w,null,x(E,n=>s("button",{key:"first-"+n.id,onClick:N(W=>O(l.tutorship_id,n.label),["stop"]),class:"ribbon-button",style:P({"--delay":n.id})},[a(o(h),{icon:n.icon},null,8,["icon"]),s("span",null,d(n.label),1)],12,Ce)),64))]),s("div",we,[(r(),c(w,null,x(F,n=>s("button",{key:"second-"+n.id,onClick:N(W=>O(l.tutorship_id,n.url),["stop"]),class:"ribbon-button",style:P({"--delay":n.id+E.length})},[a(o(h),{icon:n.icon},null,8,["icon"]),s("span",null,d(n.label),1)],12,xe)),64))])],2)],8,ge)}),128))]))]),_:1})]),_:1})}}}),Ee=ue(Ne,[["__scopeId","data-v-6cbd9548"]]);export{Ee as default};
