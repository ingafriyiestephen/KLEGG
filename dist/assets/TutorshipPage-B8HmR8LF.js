import{d as H,r as y,O as Y,o as J,a as Q,w as i,u as o,I as U,b as S,e as X,f as Z,g as n,h as G,i as $,P as K,l as ee,A as C,m as I,n as _,Q as te,q as se,s as c,k as s,R as oe,S as w,T as x,M as ne,N as r,t as d,U as A,V as ae,W as le,X as ie,Y as re,Z as ce,$ as M,a0 as de,a1 as ue,_ as pe}from"./index-CbFFUppU.js";import{T as N}from"./index-HY87JrIe.js";const he={key:0,class:"loading-container"},_e={key:1,class:"creative-empty-state"},ge={key:2,class:"class-grid"},ke=["onClick"],ve={class:"card-content"},be={class:"card-header"},fe={class:"subject-badge"},me=["onClick"],ye={class:"subject-name"},Ce={class:"ribbon-row top-row"},we=["onClick"],xe={class:"ribbon-row bottom-row"},Ae=["onClick"],Ne=H({__name:"TutorshipPage",setup(Te){const P=localStorage.getItem("parisklegg_token")||"",T=localStorage.getItem("parisklegg_user"),g=T?JSON.parse(T):null,k=(g==null?void 0:g.user_id)||0;console.log(k);const v=X(),b=y(null),u=y(!0),f=y([]),m=async()=>{try{u.value=!0;const t=await S.get("https://klegg-app-whh7m.ondigitalocean.app/api/tutorships",{headers:q(),timeout:2e4});if(isNaN(k))throw new Error("Invalid student ID");f.value=t.data.filter(e=>{var p;try{return(((p=e.students_list)==null?void 0:p.split(",").map(Number).filter(h=>!isNaN(h)))||[]).includes(k)}catch(l){return console.warn("Error parsing students_list",e),!1}}).map(e=>({...e,rating_score:e.average_rating!==void 0?parseFloat(e.average_rating.toFixed(1)):void 0}))}catch(t){z(t)}finally{u.value=!1}},E=()=>{u.value=!0,m()},R=t=>({default:"ðŸ“–"}).default,j=[{id:1,icon:ie,label:"Classroom",url:"classroom"},{id:2,icon:re,label:"Attendance",url:"attendance"},{id:3,icon:ce,label:"Assignment",url:"assignment"}],D=[{id:4,icon:de,label:"Assessment",url:"assessment"},{id:5,icon:ue,label:"Exam",url:"exam"}],F=t=>{b.value=b.value===t?null:t},V=(t,e)=>{v.push("/rate/".concat(t))},B=(t,e)=>{v.push("/".concat(e,"/").concat(t,"/"))},q=()=>({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(P)}),z=t=>{var e;if(console.error("Error fetching data:",t),S.isAxiosError(t)){if(((e=t.response)==null?void 0:e.status)===401){v.replace("/"),N.show({text:"Session expired. Please login again",position:"top",duration:"long"});return}if(t.code==="ECONNABORTED"){N.show({text:"Request timeout. Please try again",position:"top"});return}}N.show({text:"Failed to load data. Please try again later",position:"top"})},O=t=>{const e=t.matches;Z(e)};Y(async()=>{await m()});const L=()=>{const t=window.matchMedia("(prefers-color-scheme: dark)");return O(t),t.addEventListener("change",O),t};return J(()=>{L(),m()}),(t,e)=>{const p=oe("ion-spinner");return r(),Q(o(U),{class:"modern-school-theme"},{default:i(()=>[n(o(se),{class:"header-gradient"},{default:i(()=>[n(o(G),null,{default:i(()=>[n(o($),{slot:"start"},{default:i(()=>[n(o(K),{"default-href":"/home",class:"back-button"})]),_:1}),n(o(ee),{class:"page-title"},{default:i(()=>[...e[0]||(e[0]=[C("My Classes",-1)])]),_:1}),n(o($),{slot:"end"},{default:i(()=>[n(o(I),{onClick:E,fill:"clear",class:"refresh-btn"},{default:i(()=>[n(o(_),{icon:o(te),slot:"icon-only"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),n(o(ne),{fullscreen:!0,class:"content-bg"},{default:i(()=>[u.value?(r(),c("div",he,[n(p,{name:"crescent",color:"primary"}),e[1]||(e[1]=s("p",null,"Loading your classes...",-1))])):f.value.length===0?(r(),c("div",_e,[e[3]||(e[3]=s("div",{class:"desk-illustration"},[s("div",{class:"desk"}),s("div",{class:"lamp"}),s("div",{class:"book-stack"},[s("div",{class:"book"}),s("div",{class:"book"}),s("div",{class:"book"})])],-1)),e[4]||(e[4]=s("h3",null,"No Classes Yet",-1)),e[5]||(e[5]=s("p",null,"When you enroll in a class, it'll appear here",-1)),n(o(I),{onClick:E,fill:"solid",class:"cta-button"},{default:i(()=>[...e[2]||(e[2]=[C(" Check Again ",-1)])]),_:1})])):(r(),c("div",ge,[(r(!0),c(w,null,x(f.value,l=>{var h;return r(),c("div",{key:l.tutorship_id,class:"class-card",onClick:a=>F(l.tutorship_id)},[s("div",ve,[s("div",be,[s("div",fe,d(R(l.subject_name)),1),s("div",{class:"quick-action",onClick:A(a=>V(l.tutorship_id,"rate"),["stop"])},[n(o(_),{icon:o(ae)},null,8,["icon"]),C(" "+d(((h=l.average_rating)==null?void 0:h.toFixed(1))||"Rate"),1)],8,me)]),s("h3",null,d(l.tutorship_name),1),s("p",ye,d(l.subject_name),1)]),s("div",{class:le(["action-ribbon two-row",{active:b.value===l.tutorship_id}])},[s("div",Ce,[(r(),c(w,null,x(j,a=>s("button",{key:"first-"+a.id,onClick:A(W=>B(l.tutorship_id,a.label),["stop"]),class:"ribbon-button",style:M({"--delay":a.id})},[n(o(_),{icon:a.icon},null,8,["icon"]),s("span",null,d(a.label),1)],12,we)),64))]),s("div",xe,[(r(),c(w,null,x(D,a=>s("button",{key:"second-"+a.id,onClick:A(W=>B(l.tutorship_id,a.url),["stop"]),class:"ribbon-button",style:M({"--delay":a.id+j.length})},[n(o(_),{icon:a.icon},null,8,["icon"]),s("span",null,d(a.label),1)],12,Ae)),64))])],2)],8,ke)}),128))]))]),_:1})]),_:1})}}}),Be=pe(Ne,[["__scopeId","data-v-d7eb9d95"]]);export{Be as default};
